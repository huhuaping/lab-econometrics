---
title: "lab 1 Introduction of EViews"
author: "胡华平"
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    number_sections: yes
    toc: yes
    fig_caption:  true
    toc_float: true
language:
  label:
    fig: "图 "
    tab: "表 "
    def: "定义 "
    thm: "定理 "
    prp: "假设 "
    proof: "证明 "
---

# EViews 软件入门与基本操作{#introduction}

```{r global_options1, include=FALSE,message=FALSE}
knitr::opts_chunk$set(fig.align='center',echo = FALSE) # Places figures on their own pages
library('bookdown')
library('knitr')
library('xlsx')
library('lmtest')
require("DT")
require("kableExtra")
require("tidyverse")
options(digits=4,scipen=2,knitr.graphics.auto_pdf = TRUE)
```

```{r ex-math-eq}
source("external-math-equation.R")
```

## 为何选择EViews？

EViews全称为Econometrics Views，是计量经济分析的常用软件之一。1981年David Lilien开发一款名为MicroTSP（Time Series Processor）分析工具，主要用于大型计算机进行时间序列数据分析。1994年QMS（Quantitative Micro Software）公司用C++语言对MicroTSP进行重新设计，成功开发出EViews，使其广泛适用于Windows操作系统。2010年QMS公司被IHS公司收购^[参阅IHS官方网站：http://www.eviews.com/general/about_us.html]。

实际上，计量经济分析软件类型多样，功能特征各有侧重，不同使用群体根据自身情况可以灵活选择。常用的计量经济分析软件就包括SPSS、EViews、Stata、SAS、Matlab等，它们也是各有优势和不足。作为参考，不同任务情形和学习阶段应选择合适的软件：

- 计量经济初级学习者往往以菜单驱动型操作为主，适合的软件包括：
    - EViews：属于商业软件，基于C++语言
    - SPSS：属于商业软件，基于Java语言
    - Stata：属于商业软件，基于C语言
    - $\cdots$

- 计量经济中高级学习者则追求更多灵活的命令编程设计和操作，适合的软件包括：
   - Matlab：属于商业软件，基于C++、Java、MATLAB语言
   - SAS：属于商业软件，基于C语言
   - R：属于开源软件，基于C、Fortran、R语言
   - Python：属于开源软件
   - $\cdots$

计量经济学课程中使用到的数据类型主要包括截面数据（cross-section data）、时间序列数据（time series data）和面板数据（pannel data）。EViews软件因为继承了其前身软件MicroTSP的主要特征，在计量经济分析中能满足基本功能分析需求，并且拥有十分全面的时间序列分析工具。此外，EViews软件同时支持菜单型操作和命令代码操作，很适合计量经济学初学者使用，学习门槛相对较低，使用者可以集中于关注计量建模分析的理论应用与验证。而对于中高级使用者，EViews也可以进行代码编程实现各种定制化的计量分析需求，从而保证软件使用的连贯性和一致性。


## 怎样理解Eviews的运作逻辑？

- 使用者通过菜单操作基本就可以实现大部分的EViews功能
    - 主要的统计和计量分析工具都被**菜单化**设计到EViews软件中。
    - **鼠标+键盘**的操作符合使用者的直观化学习习惯。
    - 意味着使用者要**熟记**各类统计和计量分析操作的准确菜单位置，这一定程度上增加了使用者的记忆负担。

- 使用者也可以通过运行命令来实现各种EViews功能
    - 单独编写命令行，独立运行每一行命令。适用于**简单分析任务**，与菜单操作进行配合使用。
    - 批量编写命令代码，整体运行代码文件。适合于**复杂的或个性化的分析任务**，便于命令代码维护，而且代码可重复使用，可以灵活开发出使用者定制化的分析流程（往往是EViews常用分析流程不能满足需求）。
    - EViews具有**独树一帜**命令代码编写体系，使用者需要理解EViews代码规则，避免与其他统计软件代码编写规则的混淆使用。

- EViews是以对象（Object）方式来进行操作结果的管理和维护
    - 所有的数据（data）、表格（table）、图片（graph）、方程（equation）等都将保存为对象（Object）。
    - 所有的对象（Object）都存放在一个工作文件（workfile）中。
    - 所有对象都可以进行复制（copy）、粘贴（paste）、保存（save）、重命名（rename）等操作。


## 如何获取Eviews官方帮助？

作为一款商业软件，EViews能得到商业公司持续的软件维护和版本更新，不同EViews版本的界面、功能、特性等会有一定的改进和变化。2010年以后，IHS公司拥有EViews软件的商标和版权，目前发布的最新版本为EViews 10。本书所用示例均以**EViews 10**版本进行运行和演示，使用者应注意实际使用版本下可能细节上的变化和差异^[需要注意的是，目前EViews1-6将不再兼容Windows 10操作系统]。

如果正确安装EViews 10，使用者将得到IHS公司官方提供的详尽帮助手册和在线文档。菜单操作的具体获取办法是：运行EViews 10 $\Rightarrow$ 点击Help $\Rightarrow$ 下拉选择相应帮助手册或文档。

-  快速帮助手册
    * Object Reference
    * Basic Command Reference
    * Function Reference
    * Matrix Reference
    * Programming Reference
    * Online Tutorials

-  pdf帮助文档
    *  User Guide `r as.roman(1)`.pdf
    *  User Guide `r as.roman(2)`.pdf
    *  Command & Programming Ref.pdf
    *  Object Reference.pdf
    *  Eviews Illustrated.pdf

## 实验内容


```{r load-basic-data}
table_demo<-readxl::read_xlsx(path = "data/lab1-basic-development.xlsx",range="A1:E130")
# rename year and quarter
n<-dim(table_demo)[1]
year<-NULL
for (i in 1:(2012-1980+1)){
  year_tem<-rep(1980+i-1,4)
  year<-c(year,year_tem)
}
year<-year[1:n]
quarter<-paste('Q',rep(1:4,(2012-1980+1))[1:n],sep='')
table_new<-data.frame(cbind(year,quarter) )
table_demo<-cbind(table_new,table_demo[,-1])

var_lab<-data.frame(t(tolower(names(table_demo))))
names(var_lab)<-names(table_demo)
n<-dim(table_demo)[1]
k<-dim(table_demo)[2]-1
df_tss<-n-1
df_ess<-k-1
df_rss<-n-k

# give the variabl label data
label<-c("年",'季度',"国内生产总值（10亿美元）","人均消费支出（美元）","投资（10亿美元）","政府支出（10亿美元）")
table_label<-as.data.frame(list(variable=names(table_demo),label=label))
var_x<-table_label$variable[c(-1,-2,-3)]
var_y<-table_label$variable[3]
```

<!---
* 构建工作文件
    1. 配置工作文件
        * 文件名称
        * 存放路径
    2. 认清数据类型
        * 截面数据
        * 时序数据
        * 面板数据
    3. 设定样本数量
        * 观测数
        * 起始时间
        * 截面单元
* 构造变量对象
    1. 选定对象类型
        * 系统对象
        * 数据对象
        * 图表对象
        * 模型对象
        * $\cdots$
    2. 设置变量名称
    
    3. 输入变量数据
        * 键盘输入
        * 外部导入
    4.变量生成运算
        * `+ - * /` log运算
        * 赋值/提取操作
* 构建分析模型
    1. 简单图表分析
        * 相关分析矩阵
        * 散点图
        * 直方图 
        * $\cdots$
    2. 描述性统计建模
        * 集中趋势
        * 离散趋势
        * 偏态/峰态
    3. 推断性统计建模
        * 简单线性回归
        * Logistic回归
        * $\cdots$
* 模型比较检验
    1. 模型竞争比较
        * 可转化线性模型
        * 虚拟变量模型
    2. 模型检验分析
        * 经济学检验
        * 拟合优度检验
        * 统计学检验
        * 计量经济检验
        * 预测性检验
    3. 模型诊断矫正
        * 多重共线性
        * 异方差
        * 自相关
        * 自变量随机
* 撰写分析报告
    1. 简明报告
    2. 详细报告
--->

利用EViews软件进行如下操作：

* EViews 软件的启动；
* 数据的输入、编辑与序列生成；
* 图形分析与描述统计分析；
* 数据文件的存贮、调用；

## 实验准备

### 实验软件

本次实验需要提前准备好如下软件：

* 统计分析软件Eviews 9.0版本及以上
* 公式编辑软件Mathtype 6.0版本及以上
* 写作编辑软件Office Word/Excel 2010版本及以上
* 浏览器软件chrome 66.0版本及以上或 360极速浏览器9.5版本及以上

### 实验材料

### 实验规则


## EViews快速入门{#quick-sample}


**宏观经济数据**：图\@ref(fig:data-development)给出给出了某国1980年第1季度到2012年第1季度间共计`r n`个季度，关于`r paste(paste(table_label[-1,1],table_label[-1,2],sep=''),collapse = '，')`等方面的数据。

```{r data-development,fig.cap= paste0("宏观经济发展数据","(n=",n,")"),message=FALSE,results='asis',error=FALSE}
datatable(table_demo,
          options = list(pageLength=8, dom="tip")
          )

```

变量定义和说明见表\@ref(tab:label-development)：

```{r label-development,results='asis'}
library("knitr")
kable(table_label,caption = "变量定义及说明",row.names=FALSE) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
  
```


使用EViews软件分析该国宏观经济发展情况，一般需要事先将相关经济变量收集和整理成规范化的数据表（见图\@ref(fig:data-development)）。其中，每列代表变量（variables），每行代表样本（observations），数据文件格式为电子表格文件（.xlsx）等。

利用**数据导入**菜单，可以把预备好的电子表格文件（.xlsx）导入到EViews**工作文件（workfile）**中。导入数据后的EViews界面见图\@ref(fig:demon-import)

```{r demon-import,message=F,echo=FALSE,fig.cap="导入宏观经济发展数据"}
include_graphics(path = "picture/lab1-introduction/1-demon-import.png")
```



为了掌握宏观经济的样本数据特征，可以进行EViews基本的**描述性统计分析**。描述性统计分析结果见图\@ref(fig:demon-exploratory)

```{r demon-exploratory,message=F,echo=FALSE,fig.cap="宏观经济发展数据的描述性统计"}
include_graphics(path = "picture/lab1-introduction/1-demon-exploratory.png")
```

进一步地，利用**绘图**操作，可以得到4个主要变量的**多线图**（见图\@ref(fig:demon-line)）

```{r demon-line,message=F,echo=FALSE,fig.cap="4个时间序列变量的多线图"}
include_graphics(path = "picture/lab1-introduction/1-demon-line.png")
```


同时，还可以绘制对数化的国内生产总值GDP与其他变量（`r paste(var_x,collapse=',',sep='')`）之间的**相关系数表**（见图\@ref(fig:demon-corrl)）。

```{r demon-corrl,message=F,echo=FALSE,fig.cap="多个变量之间的相关系数表"}
include_graphics(path = "picture/lab1-introduction/1-demon-corrl.png")
```

一个重要的工作还包括进行回归建模分析，可以尝试如下的回归模型：

\begin{align}
GDP&=\beta_1+\beta_2PCE+\beta_3Investment+\beta_4Government+u_i (\#eq:demon-PRM)\\
GDP&=\hat{\beta}_1+\hat{\beta}_2PCE+\hat{\beta}_3Investment+\hat{\beta}_4Government+e_i (\#eq:demon-SRM)
\end{align}

利用EViews**回归分析操作**，可以得到如下的回归分析报告结果（见图\@ref(fig:demon-report)）

```{r demon-report,message=F,echo=FALSE,fig.cap="国内生产总值ln(GDP)回归结果"}
include_graphics(path = "picture/lab1-introduction/1-demon-report.png")
```



## EViews菜单操作流程

上述的快速案例速览，简要列出了使用EViews进行一次样本数据实证分析的主要步骤过程，是**典型的**实践操作流程。我们基本可以总结为如下6个步骤：

- 准备数据（data preparing）
- 构建工作文件（workfile creating）
- 构造对象（objects generating）
- 探索性分析（exploratory analyzing）
- 线性回归分析（linear regression analyzing）
- 报告结果输出（output reporting）

下面将逐条进行简要说明。

### 准备数据（data preparing）

```{r data-mess,message=FALSE,echo=FALSE,results='asis',error=FALSE}
#library('tidyr')
#library('reshape2')
# install.packages('tidyverse')
library(tidyverse)

# give the mess wide data format
mess_wide0<-spread(subset(table_demo,select = c(year ,quarter,GDP)),key=quarter,value =GDP)
names(mess_wide0)[-1]<-paste('GDP_',names(mess_wide0)[-1],sep='')

mess_wide1<-spread(subset(table_demo,select = c(year ,quarter,PCE)),key=quarter,value =PCE)
names(mess_wide1)[-1]<-paste('PCE_',names(mess_wide1)[-1],sep='')

mess_wide2<-spread(subset(table_demo,select = c(year ,quarter,Investment)),key=quarter,value =Investment)
names(mess_wide2)[-1]<-paste('Investment_',names(mess_wide2)[-1],sep='')

mess_wide3<-spread(subset(table_demo,select = c(year ,quarter,Government)),key=quarter,value =Government)
names(mess_wide3)[-1]<-paste('Government_',names(mess_wide3)[-1],sep='')

mess_wide<-cbind(mess_wide0,mess_wide1[,-1],mess_wide2[,-1],mess_wide3[,-1])

# give the mess long data format
mess_long<-gather(table_demo,key='variable',value='value',GDP:Government,factor_key = T)

mess_wide_q<-spread(mess_long,key=quarter,value = value)

# give the dims of data
k01<-dim(table_demo)[1]
k02<-dim(table_demo)[2]
k11<-dim(mess_wide_q)[1]
k12<-dim(mess_wide_q)[2]
k21<-dim(mess_wide)[1]
k22<-dim(mess_wide)[2]
k31<-dim(mess_long)[1]
k32<-dim(mess_long)[2]
```

准备数据（data preparing）属于前期准备工作，包括数据收集、清洗、整理等环节。目标是获得规范的数据表，要求每列都代表变量（variables），每行都代表样本（observations）。在进行正式EViews分析之前，提前准备一份规范的数据表是极为重要的。需要做的准备工作包括：

- 数据收集：根据研究目的设计理论模型，模型中的**理论变量**需要找到对应的现实**数据变量**。一般情况下，一个理论变量可以对应多个数据变量，但由于实际情况制约（如人力、资金、技术等条件约束），数据变量并不总是可以收集得到。
- 数据清洗：收集得到的数据并不总是完美和理想，比如常常有**数据缺失**、**虚假数据**、**错误数据**等，从而需要进行数据替换、删减、调整等操作。
- 数据整理：清洗后的数据，还需要以某种形式呈现出来。数据整理就是把数据的**统计结构**（变量和样本）与**物理结构**（行和列）进行某种匹配整合。


规范的数据表要求具有下面的结构形式[@hadley2016]：

- 每列都代表变量（variables）
- 每行都代表样本（observations）

规范的数据表可以称为**坐标型数据（Cartesian data）**，数据的统计结构和物理结构是严格对应的，也即每列代表变量，每行都代表样本，数据点通过**行坐标**和**列坐标**一起定位得到。

大部分不规范的数据表则可以称为**索引型数据（indexed data）**，数据的统计结构和物理结构并不是严格对应的，数据点往往是通过查询索引序号而得到（有点像通过偏旁部首查字典的方式）。

一份规范化的数据数据表，具有属于**坐标型数据**的形式，以表\@ref(tab:data-ok1)为例：

- 每一行都代表一个观测样本（observation），分别从1980年Q1季度到2012年Q1季度，共有`r k01`行（也即`r k01`个季度）；
- 每一列都代表一个变量（variable），分别是`r paste(paste(table_label[,1],table_label[,2],sep=''),collapse = '、')`，共有`r k02`列（也即`r k02`个变量）。
- 数据表的维度为`r paste0("(行数=",k01,';列数=',k02,")")`，统计结构和物理结构严格对应。

```{r data-ok1, fig.cap=paste0("宏观经济发展数据（规范数据表）","(行数=",k01,';列数=',k02,")")}
datatable(table_demo, options = list(pageLength=8, dom="tip")) 

```



而糟糕的数据表往往有很多种形式，下面列出三种形式（见图\@ref(fig:data-mess-wide-q)、图\@ref(fig:data-mess-wide)和图\@ref(fig:data-mess-long)）。它们都属于**索引型数据**形式，其中：

- 对于图\@ref(fig:data-mess-wide-q)：统计结构中，我们所关心的**变量**被分散在第2列所对应的各行中，而**观测样本**则被割裂在第一列对应的各行（表示年份）和第3列到第4列（表示季度）。整个数据表的维度为`r paste0("(行数=",k11,';列数=',k12,")")`，统计结构和物理结构不能一一对应，而是通过索引指标才能查到数据点。

- 对于图\@ref(fig:data-mess-wide)：统计结构中，我们所关心的**变量**与**观测样本**糅合在一起，除第1列之外，其他列都是这样的混合体，如`r names(mess_wide)[2:4]`表示国内生产总值GDP分别与Q1~Q4季度的混合。同时，**观测样本**（如1980年Q1季度）也是被割裂开来了。整个数据表的维度为`r paste0("(行数=",k21,';列数=',k22,")")`，统计结构和物理结构不能一一对应，而是通过索引指标才能查到数据点。

- 对于图\@ref(fig:data-mess-long)：该形式的数据表属于典型的**索引型数据**形式。其中，我们所关系的**变量**全部作为索引指标之一，出现在第3列（variable）；而数据值则全部出现在第4列（value）。数据值必须通过**观测样本**索引指标（第1列的year和第2列的quarter）与**变量**索引指标（第3列的variable）才能查询得到。该数据表的维度为`r paste0("(行数=",k31,';列数=',k32,")")`，统计结构和物理结构不能一一对应，而是通过索引指标才能查到数据点。


```{r data-mess-wide-q,fig.cap= paste0("宏观经济发展数据（糟糕数据表1）","(行数=",k11,";列数=",k12,")")}
datatable(mess_wide_q, options = list(pageLength=8 , dom= "tip"))

```


```{r data-mess-wide, fig.cap= paste0("宏观经济发展数据（糟糕数据表2）","(行数=",k21,";列数=",k22,")")}
datatable(mess_wide, options = list(pageLength=8 , dom= "tip"))

```

```{r data-mess-long,fig.cap= paste0("宏观经济发展数据（糟糕数据表3）","(行数=",k31,";列数=",k32,")")}
datatable(mess_long, options = list(pageLength=8 , dom= "tip"))

```

简单地总结起来就是：

- 一份**规范的数据表**（见图\@ref(fig:data-ok1)）可以直接导入到EViews的工作文件（workfile）中，并马上可以用于实证建模分析的。
- 一份**糟糕的数据表**（见图\@ref(fig:data-mess-wide-q)、表\@ref(fig:data-mess-wide)和图\@ref(fig:data-mess-long)）是**不能**直接导入到EViews工作文件（workfile）中（更严格地说，导入进去后是无意义的或无效的）。


### 构建工作文件（workfile creating）{#workfile-create}

工作文件（workfile）是EViews所有操作结果的“大容器”，操作结果将“分门别类”地以各种对象（objects）形式留存在这个“大容器”里。工作文件（workfile）的构建跟数据类型（截面数据、时间序列数据、面板数据）很有关系，一般都需要提前设置（当然也可以事后修改）。

#### 启动EViews软件

在电脑操作系统中，找到EViews安装程序，点击运行后将显示EViews软件界面（见图\@ref(fig:window-show)） 

```{r window-show,message=F,echo=FALSE,fig.cap="EViews 10软件界面"}
include_graphics(path = "picture/lab1-introduction/1-window-show.png")
```

其中界面分块情况如下：

-	标题栏：用于显示EViews任务的标题信息，并控制窗口状态。
- 菜单栏：菜单栏中排列着按照功能划分的10个主菜单选项，用鼠标单击任意选项会出现不同的下拉菜单，显示该部分的具体功能。
- 命令窗口：用户可在光标位置用键盘输入各种Eviews命名，并按回车键执行该命令。
- 工作区窗口：操作过程中打开的各子窗口在工作区内显示。
- 状态栏：Eviews主窗口的底部是状态栏，从左到右分别为：信息框、路径框、当前数据库框和当前工作文件框。


#### 创建工作文件（workfile）

进入EViews软件后的第一件工作应从创建新的或调入原有的工作文件（workfile）开始。只有新建或调入原有工作文件，EViews才允许用户输入开始进行数据处理。

EViews工作文件（workfile）的创建需要提前考虑如下几个方面：

- 工作文件的结构类型（workfile structure type），一般包括截面数据、时间序列数据、面板数据三种类型
    - 对于截面数据，可以选择**非结构型/非日期型**（Unstructured/Undated）
    - 对于时间序列数据，可以选择**有规则日期型**（Data-regular frequency）
    - 对于面板数据，可以选择平衡面板（Balanced Panel）
- 数据长度或起止时间（data specification），依据数据类型而不同
    - 对于截面数据，需要设置观测样本数（observations）
    - 对于时间序列数据，需要设置数据频率（frequency）和起止时间（start date 和end date）
    - 对于面板数据，需要设置数据频率（frequency）、起止时间（start date 和end date）和截面单元数（number of cross sections）
- 工作文件的命名（workfile names），而且在一个工作文件下可以开展多个分析任务。不同分析任务可以设置不同的子页（page），并可以对子页进行命名以便区分
- 工作文件的存放地址（path），可以决定存放在电脑本地的具体文件夹位置

此次实验演示的**宏观经济发展案例**为**时间序列数据**，我们将构建一个工作文件（workfile）和一个子页（page），具体步骤是（见图\@ref(fig:new-workfile)和图图\@ref(fig:new-workfile-ok)）：

- 启动EViews软件并新建workfile
    - 在菜单上依次点击$\Rightarrow$ File$\Rightarrow$ New$\Rightarrow$ Workfile
- 设置工作文件的结构类型（workfile structure type）
    - 点击选择**有规则日期型**（Data-regular frequency）
- 设置数据长度或起止时间（data specification）
    - 设置数据频率（frequency）：点击选择季度（Quarterly）
    - 设置起始时间（start date）：手工输入`1980/1`
    - 设置结束时间（end date）：手工输入`2012/1`
    
- 设置工作文件的命名（workfile names）
    - WF：手工输入`macro_economic`（建议命名）
    - page：手工输入`gdp`（建议命名）
- 完成设置，查看工作文件，并保存到指定本地地址。
    - $\Rightarrow$ 点击Ok。
    - 此时可以看到已经建好的工作文件视窗。
    - 保存工作文件到指定的本地地址（如`D:\econometrics\eviews\macro_economic.wf1`）。
        - 方法1（快捷保存）：在工作文件视窗下，同时按键盘Ctrl+S $\Rightarrow$ 选择本地路径地址 $\Rightarrow$ 点击确认
        - 方法2（菜单保存）：在工作文件视窗下，点击菜单栏中的Save $\Rightarrow$ 选择本地路径地址 $\Rightarrow$ 点击确认
    
```{r new-workfile,message=F,echo=FALSE,fig.cap="创建宏观经济案例的工作文件"}
include_graphics(path = "picture/lab1-introduction/1-new-workfile.png")
```

```{r new-workfile-ok,message=F,echo=FALSE,fig.cap="宏观经济案例的工作文件视窗"}
include_graphics(path = "picture/lab1-introduction/1-new-workfile-ok.png")
```

#### 导入数据{#import-data}

建立或调入工作文件以后，可以输入和编辑数据。 输入数据的基本方法有三种：


- 方式1：通过菜单操作导入（import）数据
    - 直接导入（import）**外部数据**（最为常用），支持的外部数据文件格式包括：
        - 表格文件excel file（最为常用的.xls、.xlsx）
        - 文本文件text file（较为常用的.txt、.csv、.dat）
        - 其他文件$\cdots$
    - 从EViews数据库中抓取（fetch）数据（较为常用）
    - 其他方式的导入$\cdots$
    
- 方式2：在工作文件下手工输入数据（较少使用）
    - 手工一个一个数据输入（重复且单调）
    - 复制粘贴数据，利用操作系统的剪贴板功能把外部数据复制并粘贴过来（对外部数据格式有一定要求，出错率较高）

- 方式3：在命令窗口下，使用EViews代码输入数据（较少使用，此处细节略过）

此次实验演示的**宏观经济发展案例**，我们采取方式1，直接导入已经规范化的外部表格数据（.xlsx）文件，具体操作过程为：

- 通过菜单操作读取外部文件（见图\@ref(fig:import-menu)）：
    - 在菜单上依次点击：$\Rightarrow$ File $\Rightarrow$ Import $\Rightarrow$ Import from file ...
    - 选择本地数据文件：选择文件路径`d:/econometrics/eviews/macro_economic.xlsx`（根据文件位置而定）
- 设置数据导入的引导界面：（如果数据足够规范，基本无需调整各项默认设置，见图\@ref(fig:import-intro)）。
    - step 1 of 4：设置并确认数据读取范围
    - step 2 of 4：设置并确认变量名和行数据说明
    - step 3 of 4：设置并确认缺失值和列数据说明
    - step 4 of 4：设置并确认导入方法、选项、数据结构等
    - 完成导入：点击finish
- 检查数据是否正确导入。
    - 以序列对象形式查看个别数据。在工作文件视窗下：
        - 双击打开并查看序列对象![](picture/object/Series.png)gdp
    - 以组对象形式查看全部数据（见图\@ref(fig:import-check)）。
        - 选择4个主要变量。工作文件视窗中：
            - 按住键盘CTRL键，鼠标左键依次点击选择对象![](picture/object/Series.png)gdp、![](picture/object/Series.png)pce、![](picture/object/Series.png)investment、![](picture/object/Series.png)government
        - 构造组对象。在工作文件的选定区（有底域阴影）上：
            - 点击右键$\Rightarrow$ 选择`Open` $\Rightarrow$ 选择`as Group` 
            - 得到未命名组对象![](picture/object/Group.png)UNTITLED
        - 命名组对象并保存。在未命名组对象![](picture/object/Group.png)UNTITLED视窗下
            - 点击菜单栏中的`Name` 
            - 输入命名`group_vars` （建议命名）
            - 点击`Ok`
        - 查看组对象。在工作文件视窗中，
            - 双击查看已经命名的组对象![](picture/object/Group.png)group_vars   
  


        

```{r import-menu,message=F,echo=FALSE,fig.cap="导入外部xlsx数据文件1：菜单"}
include_graphics(path = "picture/lab1-introduction/1-import-menu.png")
```

```{r import-intro,message=F,echo=FALSE,fig.cap="导入外部xlsx数据文2：引导"}
include_graphics(path = "picture/lab1-introduction/1-import-intro.png")
```

```{r import-check,message=F,echo=FALSE,fig.cap="导入外部xlsx数据文件3：检查"}
include_graphics(path = "picture/lab1-introduction/1-import-check.png")
```

### 构造对象（objects generating）

既然EViews是以对象（Object）方式来进行操作结果的管理和维护，那么所有的EViews操作过程几乎都会**“凡走过必留下痕迹”**，这些可见的“痕迹”就是**EViews对象**（object）。简言之，EViews操作中的所有信息都存放在**对象**（object）里。同时，构造对象（objects generating）是一系列EViews操作过程的**副产品**：

- 随着分析操作环节的增加，各种对象都会相应产生，如表格（table）、图片（graph）、方程（equation）等。
- 如有必要，可能还会基于某个对象产生另一个新对象，如从方程（equation）对象中提取得到系数（beta）对象；或基于X变量的序列对象（series）生成新的ln(X)序列（series）对象。

#### EViews对象（object）的**“全家福”**{#family-objects}

```{r object-data,message=FALSE,echo=FALSE,error=FALSE}
object_set<-readxl::read_xlsx('data/lab1-objects.xlsx',sheet = 'Sheet1',range='A1:F27',na='')
```

对于EViews初学者，很有必要系统地了解**EViews对象**（object）都有哪些^[可以参考在线帮助文档**Object View And Procedure Reference**，网址http://www.eviews.com/help/helpintro.html#page/content%2Fcobjects.html%23 ]。其中，尤其需要关注那些最为常用的（对于初级或中级使用者而言）EViews对象：

```{r object-show1,message=FALSE,echo=FALSE,results='asis',error=FALSE}
object1<-subset(object_set,rating>3)[,-1]
names(object1)<-list('常用指数','图标','英文名','中文名','用途')
kable(object1,booktabs = TRUE,caption = paste0("常用EViews对象列表及说明",""),row.names = FALSE) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```


其他一些不太常用（对于初级或中级使用者而言）EViews对象包括：

```{r object-show2,message=FALSE,echo=FALSE,results='asis',error=FALSE}
object2<-subset(object_set,rating<4)[,-1]
names(object2)<-list('常用指数','图标','英文名','中文名','用途')
kable(object2,booktabs = TRUE,
      caption = paste0("其他不太常用EViews对象列表及说明",""),
      row.names = FALSE) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```

在**宏观经济发展模型**案例中，我们就可以看到这些常见EViews对象的**容貌**（参看节\@ref(quick-sample)中的快速案例，以及图\@ref(fig:objects-quick)）：

- 序列（Series）对象：![](picture/object/Series.png)GDP、![](picture/object/Series.png)PCE、![](picture/object/Series.png)Government、![](picture/object/Series.png)Investment、$\cdots$
- 组（Group）对象：[](picture/object/Group.png)group_vars
- 表格（Table）对象：![](picture/object/Table.png)tab_descriptive、![](picture/object/Table.png)tab_corrl
- 图形（Graph）对象：[](picture/object/Graph.png)graph_line
- 方程（Equation）对象：![](picture/object/Equation.png)eq_gdp
- 系统保留对象（一旦建立工作文件，就会自动产生的对象）
    - 用来装载回归方程系数的**系数**（Coef）对象：![](picture/object/Coef.png)C 
    - 用来装载回归方程残差的**序列**（Series）对象：![](picture/object/Series.png)resid

```{r objects-quick,message=F,echo=FALSE,fig.cap="快速案例中的EViews对象一览"}
include_graphics(path = "picture/lab1-introduction/1-demo-objects.png")
```


#### EViews分析中常用的对象构造情形

给定特定的数据分析案例，所有的EViews操作过程要么会**直接产生**特定对象，要么迫于分析工作要求而需要**手动生成**特定对象。这些常见的对象构造情形可以初步概括为：

- 自动生成新对象。每一个具体的EViews分析操作，都会自动生成新对象。
    - 回归方程的分析操作，会直接生成一个**方程**对象![](picture/object/Equation.png)。
    - 探索性分析的绘图操作，会直接生成一个**图形**对象![](picture/object/Graph.png)。
    - 探索性分析的相关系数表计算，会生成得到一个**表格**对象![](picture/object/Table.png)。
    - 数据的矩阵运算，会直接生成一个**矩阵**对象![](picture/object/Matrix.png)。
    - $\cdots$

- 手动生成新对象。根据分析任务需要，生成某些有助于分析工作进行的新对象。
    - 通过功能菜单操作，直接生成新对象。
        - 直接生成新对象是较为常用的，使用情形包括：直接手动构造一个新**序列**![](picture/object/Series.png)用于更灵活的建模分析；手动构造一个空白**向量**![](picture/object/Vector.png)，用于后续提取并存放重要数值（如若干个对比模型的弹性系数）；$\cdots$
        - 例如，**宏观经济发展案例**中，在导入Excel数据后，我们可能还需要额外增加一个序列对象（series）`时间趋势trend`来调整样本回归模型\@ref(eq:demon-SRM)，其中变量`trend`的取值为$trend \in \{0,1,2,\cdots,`r n-1`\}$。因为原数据表.xlsx中并没有该数据，需要手动产生一个新的序列对象![](picture/object/Series.png)trend（变量名可以自己设置）    
    - 通过某些形式的公式运算，生成新对象。
        - 常用的公式运算情形包括：对数变换`log()`；倒数变换`1/X`；差分变换`d()`；滞后变量运算`x(-1)`；$\cdots$
        - 例如，**宏观经济发展案例**中，在导入Excel数据后，可能还需要使用`对数化国内生产总值log(GDP)`变量来调整样本回归模型\@ref(eq:demon-SRM)或用于其他目的的分析。因此需要通过公式变换$ln\_gdp=log(gdp)$，从而产生一个新的序列对象![](picture/object/Series.png)log_gdp（变量名可以自己设置）
    - 通过提取已存在对象的部分或全部信息，生成新对象。
        - 常用的信息提取情形包括：提取回归报告中的某些**系数**![](picture/object/Beta.png);提取方差协方差**矩阵**![](picture/object/Matrix.png)；$\cdots$
        - 例如，**宏观经济发展案例**中，为了在撰写报告时使用样本回归模型\@ref(eq:demon-SRM)中的***政府支出的产出弹性**，常常需要提取回归方程![](picture/object/Matrix.png)eq_gdp中的系数值
        
对于大部分常用Eviews对象（如表\@ref(tab:object-show1)）的创建工作，可以通过**菜单操作**来实现：

- 打开对象创建引导界面：
    - 依次点击$\Rightarrow$ Object $\Rightarrow$ New object...
- 选择并设置对象：
    - 手动选择对象类型：复选框（Type of object）选择
    - 命名对象：文本框（Name for object）输入
    - 完成操作：点击OK
- 编辑对象数值或属性
- 工作文件窗口中查看结果


下面将展示**宏观经济发展案例**中，新增创建一个序列对象（series）`时间趋势trend`（取值为$trend \in \{0,1,2,\cdots,`r n-1`\}$）的基本步骤（见图\@ref(fig:object-create)）。

- 打开对象创建引导界面。在工作视窗下：
    - 依次点击菜单栏，$\Rightarrow$ Object $\Rightarrow$ New object...
- 选择并设置对象。在对象创建引导视图下：
    - 手动选择对象类型：复选框（Type of object）选择`Series`
    - 命名对象：文本框（Name for object）输入`trend`
    - 完成操作：点击OK
- 查看并编辑对象数值。在序列对象视窗下：
    - 点击菜单栏中的Edit+/-
    - 双击单元格
    - 手动填写或编辑数值
    - 保存编辑操作，按键盘快捷组合键Ctrl+S


```{r object-create,message=F,echo=FALSE,fig.cap="常用Eviews对象的菜单式创建操作"}
include_graphics(path = "picture/lab1-introduction/1-object-create.png")
```

### 探索性分析（exploratory analyzing）


探索性分析（exploratory analyzing）是借助统计学基本原理对研究问题进行探索性分析。分析用到的一些统计学基本概念包括均值、中位数、众数、极大值、极小值、标准差、正态性、偏度、峰度、显著度等。探索性分析一般以**形象化**的**数据可视化（data visualization）**方式呈现数据特征，主要是通过表格（table）或图形（graph）的形式展现变量之间的特征、趋势、和关系。

#### 图表可视化的一般性原则

```{r chart-data,message=FALSE,echo=FALSE,error=FALSE}
chart_set<-readxl::read_xlsx('data/lab1-charts.xlsx',sheet = 'general',range='A1:F22',na='')
chart_set1<-subset(chart_set,purpose=='数据比较')
chart_set2<-subset(chart_set,purpose=='数据构成')
chart_set3<-subset(chart_set,purpose=='数据分布')
chart_set4<-subset(chart_set,purpose=='数据关系')
```

- 常用的表格形式包括：描述性统计表、相关系数表等。
    - 绘制表格主要的目的是展示确定的数值大小、汇总统计关系等
    - 原始数据可以构造形成一张表格
    - 计算得到的统计量也可以构造形成一张表格
    - 特定的分析操作，往往意味着可以得到特定的表格。例如，回归分析能得到回归分析报告表；自相关分析就能得到自相关表；$\cdots$
    

- 常用的图形形式包括：线形图（line）、描点图（dot）、柱状图（bar）、散点图（scatter）、箱线图（boxplot）等。图形可视化的关键在于——**以合适的形式，合理地呈现必要的信息！**。因此，选择合适的图形形式至为重要，而数据的类型、变量的多少等都会影响图形类型的选择。
    - 图形设计需要考虑的一些基本原则有：
        - 图中要展示多少个变量？
        - 每个变量要展示多少数据点？
        - 数据点是否以时间、项目或分组的方式呈现？
    - 根据不同的图形绘制目标，具体图形选择应视需要而定（见表\@ref(tab:chart-show)）：
        - 分析**数据比较**（Data Comparison）时，可选择`r paste(chart_set1$chart_name,collapse='、',sep='')`等图形
        - 分析**数据构成**（Data Composition）时，可选择`r paste(chart_set2$chart_name,collapse='、',sep='')`等图形
        - 分析**数据分布**（Data Distribution）时，可选择`r paste(chart_set3$chart_name,collapse='、',sep='')`等图形
        - 分析**数据关系**（Data Relationship）时，可选择`r paste(chart_set4$chart_name,collapse='、',sep='')`等图形
    

```{r chart-show,message=FALSE,echo=FALSE,results='asis',error=FALSE}
chart1<-subset(chart_set)[,c(-2)]
names(chart1)<-list('序号','绘图目的','图形示例','图形名称','图形特征')
kable(chart1,booktabs = TRUE,
      caption = paste0("探索数据比较的图形选择",""),row.names = FALSE) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

<!---
```{r chart-show1,message=FALSE,echo=FALSE,results='asis',error=FALSE}
chart1<-subset(chart_set,purpose=="数据比较")[,c(-2)]
names(chart1)<-list('序号','绘图目的','图形示例','图形名称','图形特征')
kable(chart1,booktabs = TRUE,caption = paste0("探索数据比较的图形选择",""),row.names = FALSE)
```


```{r chart-show2,message=FALSE,echo=FALSE,results='asis',error=FALSE}
chart2<-subset(chart_set,purpose=="数据构成")[,c(-2)]
names(chart2)<-list('序号','绘图目的','图形示例','图形名称','图形特征')
kable(chart2,booktabs = TRUE,caption = paste0("探索数据构成的图形选择",""),row.names = FALSE)
```


```{r chart-show3,message=FALSE,echo=FALSE,results='asis',error=FALSE}
chart3<-subset(chart_set,purpose=="数据分布")[,c(-2)]
names(chart3)<-list('序号','绘图目的','图形示例','图形名称','图形特征')
kable(chart3,booktabs = TRUE,caption = paste0("探索数据分布的图形选择",""),row.names = FALSE)
```

```{r chart-show4,message=FALSE,echo=FALSE,results='asis',error=FALSE}
chart4<-subset(chart_set,purpose=="数据关系")[,c(-2)]
names(chart4)<-list('序号','绘图目的','图形示例','图形名称','图形特征')
kable(chart4,booktabs = TRUE,caption = paste0("探索数据关系的图形选择",""),row.names = FALSE)
```

--->

#### EViews图表可视化工具集

```{r chart-eviews,message=FALSE,echo=FALSE,error=FALSE}
chart_eviews<-readxl::read_xlsx('data/lab1-charts.xlsx',sheet = 'eviews',range='A1:G28',na='')
```

EViews软件中的**表格可视化**，大多数“**隐藏**”在每一项分析操作的背后。这就意味着：

- 表格可视化应该更加重视**特定的**数据分析操作（例如序列自相关分析、或者异方差分析等）
- 然后，根据分析结果，获得一份**粗糙**的原始表格
- 最后，根据需要进行表格的细节修改和完善

与表格可视化不同，EViews软件提供了丰富的**图形可视化**工具箱（见表\@ref(tab:chart-eviews-show)），与上述图形选择的一般性原则一致，需要综合考虑图形绘制目的、变量数据特征（变量个数、变量类型、数据分组、数据趋势、时期关系$\cdots$）等。

EViews软件中**图形可视化**的基本操作过程包括：

- 选择变量数据（包括选择变量、数据分组、样本区间等）
    - 一般是选择工作文件中的组（Group）对象或序列（Series）对象

- 选择图形类型（选定什么样的数据，就会给出怎样的工具箱）
    - 根据选择变量数据的不同，图形工具箱的界面会有差异
    - EViews给出可选的图形包括：`r paste(levels(factor(chart_eviews$chart_name)),collapse='、',sep='')`等

- 设置图形细节
    - 设置图形的颜色、尺寸、边框等
    - 设置图形的坐标轴、网格线等
    - 设置图例
    - 设置图形要素
    - 设置字体
    - ……

- 保存或输出图形对象
    - 命名图形对象
    - 保存到本地文件或数据库
    - 导出为其他格式（.png/.jpg/.pdf/$\cdots$）

```{r chart-eviews-show,message=FALSE,echo=FALSE,results='asis',error=FALSE}
chart_eviews1<-subset(chart_eviews)[,c(-4,-5)]
names(chart_eviews1)<-list('序号','英文名','中文名','示例','说明')
kable(chart_eviews1,booktabs = TRUE,caption = paste0("EViews图形工具箱及示例",""),row.names = FALSE) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

下面将利用EViews菜单操作，对**宏观经济发展案例**进行简要的探索性分析。该部分内容将有助于快速了解EViews图表可视化的基本操作思路和流程。无论是表格可视化，还是图形可视化，如下的简要案例操作及过程都具有普遍的代表性，读者可以照此**举一反三**，而要达到熟练地**推而广之**则必须经历更多的实战摸索和训练。

#### EViews表格可视化：描述性统计分析表的制作{#descriptive}

首先，对**宏观经济发展案例**中的主要变量（`r paste(paste(table_label[c(-1,-2),1],table_label[c(-1,-2),2],sep=''),collapse = '、')`）进行基本**描述性统计**分析，并得到表格（table）对象形式的**描述性统计分析表**。然后，对表格（table）对象形式的**描述性统计分析表**进行美学设计，修改表格细节，实现指定要求的**三线表**形式。

- 进行基本描述性统计分析（EViews操步作骤见图\@ref(fig:explore-descriptive)）：
    - 在工作文件视窗中，单击选择已经命名的组对象![](picture/object/Group.png)group_vars
    - 在工作文件视窗中，点击菜单栏中的`Quick` $\Rightarrow$ 选择`Group Statistics` $\Rightarrow$ 选择`Descriptive Statistics` $\Rightarrow$ 选择`Common sample`
    - 确认变量对象，$\Rightarrow$ 点击`Ok`
    - 得到Group描述性统计分析视窗![](picture/object/Group.png)group_vars
    - 将描述性分析结果转换成表格。在Group描述性统计分析视窗![](picture/object/Group.png)group_vars下，$\Rightarrow$ 点击`Freeze`$\Rightarrow$ 得到表格对象视窗![](picture/object/Table.png)UNTITLED
      - 给表格对象命名。在表格对象视窗![](picture/object/Table.png)UNTITLED视窗下，$\Rightarrow$ 点击`Name`
      - 填写表格对象名称。在Object Name窗口中，$\Rightarrow$ 输入`tab_descriptive`（建议命名）$\Rightarrow$ 点击`Ok`
      - 查看保存的表格对象。在工作文件视窗中，确认可以看到已经保存的表格对象![](picture/object/Table.png)tab_descriptive
      
- 进行美学设计，修改表格细节，实现**三线表**形式的表格要求。（此处要求把**初始表格**调整为**三线表**，具体细节修改过程略。）。
    - 工作文件视窗中，双击打开表格对象![](picture/object/Table.png)tab_descriptive
    - 点击菜单`Edit+/-`，可以编辑修改单元格的内容
    - 点击菜单`CellFmt`，可以调整单元格的大小、颜色、边框等
    - 点击菜单`Title`，可以填写表格标题
    - 点击菜单`Grid+/-`，可以显示/隐藏网格线
    - $\cdots$
        
```{r explore-descriptive,message=F,echo=FALSE,fig.cap="构造主要变量的描述性统计分析表（三线表）"}
include_graphics(path = "picture/lab1-introduction/1-explore-descriptive.png")
```   

#### EViews图形可视化：多线图（Line & Symbol）的绘制

下面将展示EViews软件在多变量下的线图（Line & Symbol）的绘制过程。对**宏观经济发展案例**中的主要变量（`r paste(paste(table_label[c(-1,-2),1],table_label[c(-1,-2),2],sep=''),collapse = '、')`）进行简单的**图形可视化**，绘制简单的（标准化的）多变量线图（Line & Symbol）的主要过程如下：（见图\@ref(fig:explore-line-basic)）

- 选择组（Group）对象。在工作文件视窗下，
    - 鼠标单击选择已经命名的组对象![](picture/object/Group.png)group_vars。
    - 点击菜单栏中的`Quick` $\Rightarrow$ 选择`Graph`
    - 确认变量对象，点击`Ok`
- 设置图形引导界面。在引导窗口的目录`Graph Options` 中，分别点击设置如下子选项页：
    - Graph type （图类型）子选项页，主要用于修改图形类型
        - General（通用）下拉框
            - 下拉选择Basic graph
        - **Specific（设置）复选框**（比较常用的选项设置）
            - 点击选择Line & Symbol
        - Detail（细节）选项区，有多个设置下拉框选择 
            - Graph data（图形数据）下拉框
                - 默认设置
            - Orientation（方向）下拉框
                - 默认设置
            - Axis Borders（坐标轴边框）下拉框
                - 默认设置
            - Multiple series（多序列）下拉框
                - 下拉选择Single graph
    - Frame & Size（图框和大小）子选项页，主要用于设置图形的颜色/边框、大小/缩进等
        - 默认设置
    - Axes & Scaling（图轴和度量）子选项页，主要用于设置数据尺度、数轴标签、网格线等
        - 默认设置
    - Lgend（图例）子选项，主要用于设置图例相关选项
        - 默认设置
    - Graph Element（图形元素）子选项，主要用于设置线型/符号、填充块等
        - 默认设置
    - Quick Fonts（快速字体）子选项页，用于调整字体
        - 默认设置
    - Templates & Objects（样式和对象），用于套用样式等
        - 默认设置
    - Graph Updating（图形更新）子选项页，用于更新修改
        - 默认设置
    - 完成设置。
        - 点击`Ok` 
        - 将得到未命名图形对象![](picture/object/Graph.png)UNTITLED
- 命名并保存图形对象。在未命名图形对象![](picture/object/Graph.png)UNTITLED窗口中
    - 点击菜单栏`Name` $\Rightarrow$ 输入命名`graph_line` $\Rightarrow$  点击`Ok`
    - 可以看到工作文件中，将出现已命名并保存的图形对象![](picture/object/Graph.png)graph_line

```{r explore-line-basic,message=F,echo=FALSE,fig.cap="主要变量的简单多线图（Line & Symbol）绘制"}
include_graphics(path = "picture/lab1-introduction/1-explore-line-basic.png")
```


此外，根据研究报告撰写的特定要求，可以对图形进行个性化美学设计。美化图形，修改细节，使其满足**个性化美学**要求（见图\@ref(fig:explore-line-basic)，具体步骤此处略）。

- 工作文件中，双击打开已保存的图形对象![](picture/object/Graph.png)graph_line
- 操作并编辑各种图表细节，在图形对象![](picture/object/Graph.png)graph_line视窗中：
    - 点击菜单`name`，可以修改图形对象命名
    - 点击菜单`Freeze`，可以设置图形是否**冻结**或**可更新**（如手工调整样本区间等）
    - 点击菜单`Options`，可以修改各种图形元素（**这是最常用的细节修改内容**）
        - `Graph Type`，用于修改图形类型
        - `Frame & Size`，用于修改图形大小、边框等
        - `Axes & Scaling`，用于修改图形坐标轴、网格线、标尺等
        - `Legend`，用于修改图形的图例
        - `Graph Elements`，用于修改图形的数值标签、线型、符号等
        - `Quick Font`，用于修改图形的字体
        - `Templates & Objects`，用于快速套用图形样式
        - `Graph Updating`，用于图形修改更新
    - 点击菜单`Update`，可以更新图形修改结果
    - 点击菜单`AddTex`，可以给图形添加文本
    - $\cdots$

```{r explore-line-fine,message=F,echo=FALSE,fig.cap="主要变量的个性化多线图（Line & Symbol）绘制"}
include_graphics(path = "picture/lab1-introduction/1-explore-line-fine.png")
```



### 线性回归分析（linear regression analyzing）{#log-log}

线性回归分析（linear regression analyzing）是用来探究现象之间因果作用关系的最重要工具之一。线性回归分析属于一类有助于直观地理解复杂问题的**理想化**分析工具，一般需要较严苛的**假设条件**。

EViews进行线性回归分析中需要考虑的问题可繁可简，取决于问题的复杂程度、研究的细致程度、条件的满足程度等等。一般而言，线性回归分析都需要进行：模型选择和调试、统计学检验（如t检验、F检验等）、计量经济学检验（如多重共线性、异方差、自相关等检验）、预测性检验、稳健性检验等。


为了简便起见，下面将对**宏观经济发展案例**中的对数模型（见节\@ref(quick-sample)中的样本回归模型\@ref(eq:demon-SRM)）进行EViews线性回归分析。Eviews菜单操作的具体步骤为（见图\@ref(fig:regression-m0)）：

-  进入方程分析的设置菜单。
    - 在工作文件视窗下，点击菜单栏中的`Quick` $\Rightarrow$ `Estimation Equation` $\Rightarrow$ 将看到方程估计的引导界面

-  完成引导设置。方程估计的引导界面`Equation Estimation`下，进行如下设置：
    - 设置方程。`Equation Estimation` $\Rightarrow$ `Specification`
        - 方程设置`Equation specification`：依次输入变量  `r paste(tolower(var_y), ' c ',paste(paste(tolower(var_x),sep=''),collapse = ' ',sep=''),sep='')`（注意变量之间的空格，以及截距`c`）
        - 估计方法`Estimation settings`：
            - 方法`Method`: 下拉选择`LS - Least Squares (NLS and ARMA)`
            - 样本`Sample`:  **默认设置**

    - 设置细节选项。`Equation Estimation` $\Rightarrow$ `Options`
        - 协方差设置`Coefficient Covariance` $\Rightarrow$ （细节略）
        - 权重设置`Weights` $\Rightarrow$ （细节略）
        - 优化算子设置`Optimization` $\Rightarrow$ （细节略）
    
    - 完成设置，点击`OK` $\Rightarrow$ 将得到未命名的方程对象![](picture/object/Equation.png)UNTITLED

-  命名并保存回归方程。
    - 在未命名的方程对象![](picture/object/Equation.png)UNTITLED视窗下，点击菜单栏`Name`  $\Rightarrow$ 输入命名`eq_main`（建议命名） $\Rightarrow$ 完成命名，点击`Ok`
    - 此时，在工作文件视窗下可以看到已经保存命名的方程对象![](picture/object/Equation.png)eq_main
    
------------------- -------------------------------------------------------------------------------
![](picture/general/tips1.png)      - 构建并比较多个类似方程时，
                    可以复制、粘贴、重命名多个方程对象![](picture/object/Equation.png)\
                    - 可以随时修改方程的属性，在方程对象![](picture/object/Equation.png)
                    视窗下，点击菜单栏中的`Estimate` $\Rightarrow$ 重新设置`Equation Estimation`\

---------------------------------------------------------------------------------------------------


```{r regression-m0,message=F,echo=FALSE,fig.cap="主回归模型Eviews操作"}
include_graphics(path = "picture/lab1-introduction/1-regression-m0.png")
```   
    
### 报告结果输出（output reporting）

Eviews操作结果是以对象（object）形式存储在工作文件（workfile）中，在撰写研究报告时，往往需要呈现这些分析结果和主要结论。报告结果输出（output reporting）是指把EViews分析的结果**导出**或**呈现**在研究报告中的过程或操作。根据研究报告内容的实际需要，EViews的对象可能需要完整输出，也可能只是提取对象中的部分元素。但无论如何，进行合理的选取、整合、呈现、展示是极为必要的。例如：

- 调整图形（graph）和表格（table）的各种美学细节以符合论文或报告的格式要求，如字体、颜色、线条、形状、图例、坐标等
- 选取并整合成新的表格，如三线表、多模型对比表
- 把一个EViews原始的回归分析报告（raw report），处理成简要报告（simple report），一般表达为三行或四行，包括样本回归方程（第一行）、回归系数的标准误（第二行）、t值（第三行）、拟合情况（第四行，包括拟合优度$R^2$，F检验值、DW检验值等）
- $\cdots$

<!--- 此处将放置一个专栏，展示报告结果输出的基本形式 --->

对于如下的回归方程：

```{r prm-classic-model-coef,error=FALSE,results='asis',message=FALSE,echo=FALSE}
models<-list(classic_model=GDP~PCE+Government+Investment)
fun_report_prm(lm.mod = models$classic_model,lm.dt = table_demo,
            lm.label = "prm-classic-model")
lm_output<-fun_lm_output(lm.mod = models$classic_model,lm.dt = table_demo)
```

其回归报告，可以简要写成：

```{r classic-model-coef,error=FALSE,results='asis',message=FALSE,echo=FALSE}
models<-list(classic_model=GDP~PCE+Government+Investment)
fun_report_eq(lm.mod = models$classic_model,lm.dt = table_demo #,lm.label = "classic-model-coef"
              )
```


## Eviews编程体系及语法{#command-system}

```{r fun-color,message=F,echo=FALSE }
# define Color Format function for paragraph text
colFmt = function(x,color){
  outputFormat = opts_knit$get("rmarkdown.pandoc.to")
  if(outputFormat == 'latex')
    paste("\\textcolor{",color,"}{",x,"}",sep="")
  else if(outputFormat == 'html')
    paste("<font color='",color,"'>",x,"</font>",sep="")
  else
    x
}
```

### 命令运行方式

EViews提供了菜单和命令两种方式进行数据分析和处理。事实上，只要能够通过**窗口菜单**完成的功能，就都可以通过**命令窗口**中输入相应编程命令来执行实现。根据任务的复杂性、重复性、繁重性等的不同，EViews可以通过如下方式完成分析任务：

- （**方式1**）**完全窗口菜单驱动**，也即通过选择特定菜单栏功能进行分析操作
    - 适合于简单的、一次性的、工作量小的分析任务
    - 适合于EViews软件初学者，可以更加集中于统计分析和计量分析本身
    - 优点：图形用户界面使得操作十分直观，常用对象窗口和菜单相对固定，简单的几次反复练习后便会形成稳定的“记忆路径”
    - 不足：操作效率较低，难以在底层上实现**“掌控一切”**的状态

- （**方式2**）**完全程序命令驱动**，也即通过执行特定编程命令来进行分析操作，具体又可分为两种情形：
    - （**方式2.1**）**交互式命令驱动**，也即在**命令视窗**中逐条地编写程序代码，逐条运行各个编程命令
        - 类似于“看一步走一步”的模式，命令编程不需要十分严格的逻辑安排
        - 只要有特定分析需要，就随时编写命令，随时执行编程命令，得到想要的分析结果
        - 适合于相对复杂、有一定重复性，但又不太繁重的分析任务
        - 优点：灵活、自由，可以与菜单操作（方式1）互相结合——只要需要就可随时登台“串场”发挥作用！
        - 不足：代码管理困难，条理性较差，需要繁琐的手工编写和操作
    - （**方式2.2**）**批量式命令驱动**，也即在**程序文件**中系统地编写程序代码，自动运行全部编程命令
        - EViews程序文件为**.prg**文件后缀，是一类通用**文本文件**，所有代码都以**文本**形式进行编写、组织和管理。
        - 类似于“照着剧本演戏”的模式，所有“剧本”内容（程序代码）都是经过精心设计和安排的
        - 一开始分析任务就极为明确，程序命令有整体“剧情”，各命令间的联系、顺序等逻辑性较强
        - 适合于较为复杂、重复性较高、极为繁重的分析任务
        - 优点：代码管理方便，代码可重复使用，代码逻辑性强，分析操作过程的条理性很清晰
        - 不足：需要系统掌握EViews编程语言，学习使用成本较大；需要较强的代码管理和统计分析逻辑，容易出现各类运行报错。

- （**方式3**）菜单窗口和程序命令**并行驱动**，也即同时结合了功能菜单和编程命令来开展相关分析工作
    - 往往都是**菜单驱动**加上**视窗命令**
    - **菜单驱动**的优点是简单直观（类似于“所见即所得”），不足是功能菜单的操作效率较为低下
    - **命令视窗**的优点是底层操作（类似于“我思故我在”），不足是命令语法的学习曲线较为陡峭，记忆负担大，代码写作要求较高
    - 优点：易用，上手快，特别适合于EViews中级或高级进阶学习。有效结合菜单操作和命令操作两种方式，相互取长补短，提高数据分析效率
    - 不足：常常要在菜单操作和命令操作两种方式中随时“切换”，容易引起分析混乱；又要熟悉功能菜单选项，又要记忆命令代码，可能“两边不讨好”。

#### 菜单窗口和程序命令并行驱动{#both}

如前所述，**菜单窗口和程序命令并行驱动**，同时结合了功能菜单和编程命令来开展相关分析工作，是数据分析实践中最常用到的、最受初学者欢迎的操作方式之一。这种操作方式，首先需要掌握功能菜单驱动的数据分析操作，同时还要求了解并使用最基本的EViews编程语言进行简单代码编写和运行分析。总体看来，这种操作方式下，以**功能菜单操作**为主，以**视窗命令操作**为辅——数据分析者将主要利用菜单操作完成主要的常规性分析任务，而一些非常规的、需要定制化的分析任务则交给视窗命令去执行。

下面通过**宏观经济发展案例**演示基本操作步骤，将展示“功能菜单操作-视窗命令操作”的交互执行。其中数据分析的目标任务有两个：一是得到一个向量（Vector）对象![](picture/object/Vector.png)，用于存放判定系数$R^2$和调整判定系数；二是得到一个标量（Scalar）对象![](picture/object/Scalar.png)，用于存放给定显著性水平$\alpha=0.05$，且自由度为$f=128$时，理论查表t值$t_{1-\alpha/2}(f)=t_{0.975}(128)$。

- 假设前期已完成如下**菜单操作**工作：
    - （见节\@ref(workfile-create)）已经成功创建了工作文件![](picture/general/workfile-size.png)macro_economic
    - （见节\@ref(workfile-create)）已经成功导入数据
    - （见节\@ref(log-log)）已经通过菜单操作进行双对数回归分析，并得到方程对象![](picture/object/Equation.png)eq_main
    - 双击方程对象![](picture/object/Equation.png)eq_main可以查看EViews给出的回归分析报告
        - 可以看到，回归方程拟合优度中的判定系数$R^2=`r formatC(lm_output$R2,digits=6,format="f")`$，调整判定系数判定系数$\bar{R}^2=`r formatC(lm_output$R2.adj,digits=6,format="f")`$

- 目标任务1（见图\@ref(fig:task-fitness)）：通过**视窗命令操作**，提取出双对数回归方程中的判定系数$R^2$和调整判定系数$\bar{R}^2$，并将这两个数值分别存放在一个向量（Vector）对象![](picture/object/Vector.png)vec_fitness中。
    - 在命令视窗中：
        - 输入代码行`vector(2) vec_fitness(1)=eq_main.@r2`
        - 鼠标光标停留在该代码行上 $\Rightarrow$ 然后按Enter键，便可以运行该代码行!
    - 在工作文件视窗下：
        - 将看到生成了一个向量对象![](picture/object/Vector.png)fitness
        - 双击查看![](picture/object/Vector.png)fitness，发现该向量含有两个元素，其中第一个元素为`r formatC(lm_output$R2,digits=6,format="f")`（也即回归方程的判定系数$R^2$值），第二个元素为0.000000
    - 在命令视窗中：
        - 输入代码行`vec_fitness(2)=eq_main.@rbar2`
        - 鼠标光标停留在该代码行上 $\Rightarrow$ 然后按Enter键，便可以运行该代码行!
    - 在工作文件视窗下：
        - 双击查看![](picture/object/Vector.png)vector_fitness，发现该向量含有两个元素，其中第一个元素为`r formatC(lm_output$R2,digits=6,format="f")`（也即回归方程的判定系数$R^2$值），第二个元素为`r formatC(lm_output$R2.adj,digits=6,format="f")`（也即回归方程的调整判定系数$\bar{R}^2$值）

```{r task-fitness,message=F,echo=FALSE,fig.cap="通过命令视窗提取回归方程的判定系数$R^2$和调整判定系数$\bar{R}^2$"}
include_graphics(path = "picture/lab1-introduction/1-task-fitness.png")
``` 



- 目标任务2（见图\@ref(fig:task-tvalue)）：通过**视窗命令操作**，得到一个标量（Scalar）对象![](picture/object/Scalar.png)t_value，用于存放给定显著性水平$\alpha=0.05$，且自由度为$f=125$时，理论查表t值$t_{1-\alpha/2}(f)=t_{0.975}(125)$。
    - 在命令视窗中：
        - 输入代码行`scalar t_value=@qtdist(0.975,125)`
        - 在该代码行上按Enter键
    - 在工作文件视窗下中：
        - 将看到生成了一个标量对象![](picture/object/Scalar.png)t_value
        - 双击查看![](picture/object/Scalar.png)t_value，发现该标量含有一个元素，其数值为`r qt(0.975,125)`（也即计算表明，在给定显著性水平$\alpha=0.05$，且自由度为$f=125$时，理论查表t值$t_{1-\alpha/2}(f)=t_{0.975}(125)=`r qt(0.975,125)`$）

```{r task-tvalue,message=F,echo=FALSE,fig.cap="通过命令视窗计算得到理论t值$t_{1-\alpha/2}(f)=t_{0.975}(125)$"}
include_graphics(path = "picture/lab1-introduction/1-task-tvalue.png")
``` 


#### 批量式命令驱动

下面将简要介绍**（方式2.2）批量式命令驱动**运行模式的基本操作。作为EViews高级学习技巧，很有必要理解EViews程序文件![](picture/general/prg-size.png)（文件后缀名为.prg）的创建和运行操作：

- 创建程序文件（见图\@ref(fig:prg-file)）。
    - 在工作文件视窗下，依次点击选择菜单栏File $\Rightarrow$ New $\Rightarrow$ Program。
    - 命名并保存程序文件。在程序文件视窗下，点击菜单栏Save $\Rightarrow$ 确定文件存放地址（如本地文件夹"d:\\econometrics\\eviews"下），输入文件名`first_program`（建议命名，可修改）$\Rightarrow$ 完成，点击OK
    - 查看已保存的程序文件![](picture/general/prg-size.png)并双击打开。  在本地文件夹下（如"d:\\econometrics\\eviews"）可以看到程序文件![](picture/general/prg-size.png)first_program.prg，可双击打开

- 使用程序文件视窗的功能菜单。
    - 在程序文件视窗（Program:first_grogram）下，可以看到如下功能菜单
        - 运行菜单（Run）：用于运行全部代码
        - 打印菜单（Pringt）：
        - 保存菜单（Save）和另存菜单（SaveAs）：
        - 剪切菜单（Cut）、拷贝菜单（Copy）和粘贴菜单（Paste）：
        - 插入文本菜单（InsertTxt）：
        - 查找菜单（Find）和替换菜单（Replace）：
        - 打包命令菜单（Wrap+/-）：用于封装命令
        - 代码行号菜单（LineNum+/-）：用于显示或隐藏代码行号
        - 加密菜单（Encrypt）：用于给程序文件加密
    
- 在程序文件![](picture/general/prg-size.png)中编写、管理和运行EViews代码。
    - 根据EViews编程语言规则（见节\@ref(language)），直接以文本形式编写程序代码。
    - 执行整个程序文件。在检查确认整个程序文件的全部代码后，可以直接运行整个程序文件。在程序文件视窗（Program:first_grogram）下，点击菜单栏中的Run
    - 执行部分代码行。
        - **选中**已经编写的代码命令行，点击鼠标右键，选择Run Selected
        - **选中**已经编写的代码命令行，点击鼠标右键，还可以看到其他一些常用的快捷菜单。

```{r prg-file,message=F,echo=FALSE,fig.cap="EViews程序文件（.prg）的创建操作"}
include_graphics(path = "picture/lab1-introduction/1-prg-file.png")
```  


下面所示为EViews程序文件![](picture/general/prg-size.png)my_first_program.prg的代码文本，运行该EViews程序文件，将可以完全地、自动地再现第一章中“宏观经济发展案例”主要分析步骤，包括：

- 创建工作文件。（工作文件名=development，子页命名=gdp）（效果与节\@ref(workfile)相同）
- 导入外部数据。（效果与节\@ref(import-data)相同）
- 构造组（Group）对象![](picture/object/Group.png)group_vars。（效果与节\@ref(descriptive)相同）
- 得到描述性分析的表格（Table）对象![](picture/object/Table.png)tab_descriptive。（效果与节\@ref(descriptive)相同）
- 得到堆栈多线图（Line & Symbol）的图形对象![](picture/object/Graph.png)graph_line。（效果与节\@ref(descriptive)相同）
- 进行双对数线性回归模型分析，得到方程（Equation）对象![](picture/object/Equation.png)eq_main。（效果与节\@ref(log-log)相同）
- 提取出双对数回归方程中的判定系数$R^2$和调整判定系数$\bar{R}^2$，并将这两个数值分别存放在一个向量（Vector）对象![](picture/object/Vector.png)vec_fitness中。（效果与节\@ref(both)相同）
- 计算得到给定显著性水平$\alpha=0.05$，且自由度为$f=125$时，理论查表t值$t_{1-\alpha/2}(f)=t_{0.975}(125)$，并将这个计算值存放到一个标量（Scalar）对象![](picture/object/Scalar.png)t_value中。（效果与节\@ref(both)相同）


```
'======================================================================================================
'说明：以下为EViews编程文件my_first_program.prg的代码
'      将展示第一章中“宏观经济发展案例”主要分析步骤的“批量式命令驱动”实现方法(:：
'      其中，符号'起头的行，为注释行，其他为EViews命令行。
'======================================================================================================

'[命令行`r q<-1;q`]：创建工作文件（工作文件名=development，子页命名=gdp），季度数据，起始于1980年1季度，结束于2012年1季度
wfcreate(wf=development,page=gdp)  q  1980/1 2012/1

'[命令行`r q<-q+1;q`]：导入外部数据，路径为d:\economitrics\macro-economic.xlsx
import d:\economitrics\macro-economic.xlsx

'[命令行`r q<-q+1;q`]：构造组对象，名为group_vars，由序列gdp; pce; investment; government构成
group group_vars gdp pce investment government

'[命令行`r q<-q+1;q`]：得到表格（表格命名为tab_descriptive）<----组对象group_vars.进行描述性统计分析（Descriptive statistics）
freeze(tab_descriptive) group_vars.stats

'[命令行`r q<-q+1;q`]：进行绘图，图形名为graph_line线图（堆栈图）<----对组对象group_vars
graph graph_line.line(s)  group_vars

'[命令行`r q<-q+1;q`]：构建方程，给方程命名为eq_main执行线性回归
'   其中，线性方程为 gdp ~ c+ pce+ investment+ government
equation eq_main.ls gdp c pce investment government

'构造向量（含有2个元素），并将向量命名为vec_fitness，其中：
' [命令行`r q<-q+1;q`]：向量的第1个元素将用于提取并存放方程eq_main中的判定系数R^2
' [命令行`r q<-q+1;q`]：向量的第1个元素将用于提取并存放方程eq_main中的调整判定系数$\bar{R}^2$
vector(2) vec_fitness(1)=eq_main.@r2
vec_fitness(2)=eq_main.@rbar2

'[命令行`r q<-q+1;q`]：构造标量，标量命名为t_value=利用函数@qtdist(p,f)计算理论t值（a=0.05，f=125）
scalar t_value=@qtdist(0.975,125)

'=======================================================================================================
```

通过以上EViews程序文件![](picture/general/prg-size.png)my_first_program.prg，可以初步对EViews编程语言及命令体系有一个直观的认知，并可以利用数据进行实证练习。当然，里面的很多EViews编程命令与代码，会令初学者不知所以然（尽管只需要修改外部数据文件路径，就能完全再现实验分析结果）。因此，本章后续内容将会帮助梳理和总结EViews编程的命令语法结构，以及常用命令及函数。


### 命令语法结构{#language}

实际上**EViews编程语言**源自于一种比较**古老的**编程语言，最早于1965年由Robert Hall开发而成。**EViews编程语言**有其自身的体系性和逻辑性。如果具备一定的编程基础，可以很快掌握基本的EViews编程技巧。总体来看，学习**EViews编程语言**需要把握如下几个基本原则：

- Eviews编程的**“前台”**是各种EViews工作文件对象（workfile object，见节\@ref(family-objects)），这些都是在**“前台”**——工作文件视窗下——**“可见的”**。
    - 这些EViews工作文件对象（workfile object）包括：序列（Series）对象![](picture/object/Series.png)、方程（Equation）对象![](picture/object/Equation.png)、表格（Table）对象![](picture/object/Table.png)、图形（Graph）对象![](picture/object/Graph.png)、标量（Scalar）对象![](picture/object/Scalar.png)等
    - 大部分Eviews编程代码都会**直接**作用于或指向这些EViews工作文件对象（workfile object）
    - Eviews编程代码直接产生的各种EViews工作文件对象，也往往就是数据分析的**直接成果**，将用于报告撰写，也是数据分析的最重要目标之一。
    
- Eviews编程的**“后台”**是**命令视窗**或者**编程文件.prg**![](picture/general/prg-size.png)，所有EViews命令代码在这里被编写、管理和运行。
    - 其中的一些EViews命令代码，可能只是**辅助性地**帮助实现**前台**的结果——这些命令代码本身并不会直接“可见的”，也即不会**直接作用**或**直接指向**“EViews工作文件对象”。
    - EViews开发有一系列**编程变量**（programming variables），它们大多只是在“后台”发挥**桥梁**或**表征**作用，从不直接在“前台”现身。
        - **控制变量（control variables）**，用以代表数值型的变量，用感叹号!做前缀表达。例如，编写并运行命令`!x=7`，表示生成一个数值型变量`x`，其值为7。然而即便运行此命令行，在工作文件视窗下，也不会产生任何EViews工作文件对象——但控制变量`x`确确实实是隐身在**后台**，并可以发挥作用的！
        - **字符变量（string variables）**，用以代表字符型的变量，用百分号%做前缀表达。例如，编写并运行命令`%model="gdp~ c + investment + pce + government"`，表示生成一个字符型变量model，其值为`"gdp~ c + investment + pce + government"`。同理，即便运行此命令行，在工作文件视窗下，也不会产生任何EViews工作文件对象——也即字符变量`model`是隐身在**后台**发挥作用的！

- 作为初级或中级Eviews编程学习者，应该重点关注**数据分析目标的实现**而不是**程序运行效率的提高**。也就是说：
    - 紧密围绕“可见的”工作文件**对象（object）**进行EViews代码编程，直接得到可见的分析结果
    - 为了提高编程代码的运行效率，或者为了改善编程代码的简洁性（很多编程者都会被认为有“代码洁癖”倾向），或者为了数据分析的代码可重复性使用，诸如此类目标的实现往往都需要对代码进行“费尽心机”的后台安排和管理。如果这些目标并不那么重要，这些“令人尊敬”的编程努力也就完全有理由可以暂时放弃。


因此，假定Eviews编程学习者关注的重点是**数据分析目标的实现**，下面将展示EViews编程语言中基于对象（object）的一种标准语法结构（注意空格的使用）：

<div id="div2">
<a id="action">**action**</a><a id="options">**(action_opt)**</a> <a id="object_name">**object_name**</a>.<a id="view_or_proc">**view_or_proc**</a><a id="options">**(options_list)**</a> <a id="arg_list">**arg_list**</a>
</div>

    
该语法结构的大意是：将会执行一项动作（action），这项动作的执行必须按照若干标准（action_opt），这项动作将会施加在一个对象（名为object_name）的某种可执行状态上（view_or_proc），对象上的这种可执行状态可以是对象的视图（view）或者程序（proc），并且可能会要求提供这种状态下的具体要求（options_list），而这种状态（view_or_proc）的出现或执行也需要具体的参数条件。其中：

- <a id="action">**action**</a>表示**动作（action Commands）**命令，包括：
    - <a id="action">**show**</a>表示显示结果
    - <a id="action">**do**</a>表示执行指定程序
    - <a id="action">**freeze**</a>表示从对象视窗中生成表格或图形
    - <a id="action">**print**</a>表示打印对象视窗

- <a id="options">**(action_opt)**</a>表示动作（action Commands）命令的各种**选项设置（options）**

- <a id="object_name">**object_name**</a>表示EViews的**对象名（object name）**，例如：
    - 名为<a id="object_name">**eq_main**</a>的方程对象![](picture/object/Equation.png)eq_main
    - 名为<a id="object_name">**gdp**</a>的序列对象![](picture/object/Series.png)gdp
    - 名为<a id="object_name">**graph_line**</a>的图形对象![](picture/object/Graph.png)graph_line

- <a id="view_or_proc">**view_or_proc**</a>表示对象可用于执行的**视窗或程序命令（View and Procedure Commands）** 
    - 对于不同的对象（object），其可用于执行的**视窗或程序命令**，都不尽相同。例如，序列（Series）对象![](picture/object/Series.png)ser01可用于执行的**视窗（View）命令**包括：
        - 显示为表单和描述性统计，分别是：ser01.sheet；ser01.stats
        - 显示为图形，包括：ser01.line；ser01.bar；ser01.hist
        - 显示为表单，包括：ser01.freq；ser01.correl；ser01.lrvar；ser01.uroot；ser01.vratio 2 4 8；ser01.bdstest；$\cdots$
        - $\cdots$

- <a id="options">**(options_list)**</a>表示对象可用于执行视窗或程序命令（View and Procedure Commands）的各种**选项设置（options）**

- <a id="arg_list">**arg_list**</a>表示视窗或程序命令下的语法**参数（arguments）**
    - 例如，方程对象![](picture/object/Series.png)eq_main的线性回归程序表达为`eq_main.ls`，就需要提供线性回归方程参数：`gdp c investment pce government`，也即方程$gdp=\hat{\beta_1}+\hat{\beta_2}investment+\hat{\beta_3}pce+\hat{\beta_4}government+e_i$


下面将展示3条典型的EViews编程命令行，它们的语法结构类似，但运行结果则迥然不同：

```
'说明：以下三个EViews命令行，将简要展示EViews编程的语法结构及其特征。
'      其中，符号'起头的行，为注释行，其他为EViews命令行。
' ===========================================================================
' 命令行1：生成线性回归方程对象eq_main01
equation eq_main01.ls gdp c investment pce government

' 命令行2：生成并打开线性回归方程对象eq_main02
show eq_main02.ls gdp c investment pce government

' 命令行3：生成线性回归方程对象eq_main03，并将回归报告保存为表格对象tab_output
freeze(tab_output) eq_main03.ls gdp c investment pce government
' ===========================================================================
```

以上3条EViews编程命令行的具体解读如下：

- 命令行1解读：将生成线性回归方程对象![](picture/object/Equation.png)eq_main01
    - `equation`表示声明（declare）一个方程对象![](picture/object/Equation.png)
    - `eq_main01`表示对象名（object_name）
    - `.ls`表示对方程对象执行一个叫`ls`（也即线性回归分析）的程序（proc）
    - `gdp c investment pce government`表示执行`ls`（也即线性回归分析）程序（proc）需要调用的参数（此处为设定回归方程）
    
- 命令行2解读：将生成并打开线性回归方程对象![](picture/object/Equation.png)eq_main02
    - `show`表示执行一个名为`show`（也即展示结果）的动作（action）
    - `eq_main02`表示对象名（object_name）
    - `.ls`表示对方程对象执行一个叫`ls`（也即线性回归分析）的程序（proc）
    - `gdp c investment pce government`表示执行`ls`（也即线性回归分析）程序（proc）需要调用的参数（此处为设定回归方程）

- 命令行3解读：将生成线性回归方程对象![](picture/object/Equation.png)eq_main03，并将回归报告保存为表格对象![](picture/object/Table.png)tab_output
    - `freeze(tab_output)`表示执行一个名为`freeze`（此处为保存表格）的动作（action）；括号内的`tab_output`为执行该动作的选项设置（action_opt），此处表示保存的表格命名为`tab_output`
    - `eq_main03`表示对象名（object_name）
    - `.ls`表示对方程对象执行一个叫`ls`（也即线性回归分析）的程序（proc）
    - `gdp c investment pce government`表示执行`ls`（也即线性回归分析）程序（proc）需要调用的参数（此处为设定回归方程）

总体而言，以上演示只是一种常用的典型语法结构，是基于对象（object）进行操作。实际上，EViews编程语法结构有多种多样，有的是标准化语法结构，有的是简化语法结构，还有更多的约定式语法结构，深入掌握的话需要进行大量记忆，或者查看EViews官方的命令参考书[@IHS-command]。无论如何，围绕对象（object）进行EViews编程是一条切实有效的学习途径，而EViews官方[在线帮助文档](http://www.eviews.com/help/helpintro.html#page/content%2Fcobjpreface.html%23)^[http://www.eviews.com/help/helpintro.html#page/content%2Fcobjpreface.html%23]提供了全面的对象参考（object reference），并分类列出了全部的相关命令，对EViews编程很有帮助：

- 对象的声明（Declaration）
- 对象的方法（Methods）
- 对象的视窗（Views）
- 对象的可执行程序（Procs）
- 对象的可返回数据（Data Members）

### 常用命令及函数

```{r commands-data,message=FALSE,echo=FALSE,error=FALSE}
commands_set<-readxl::read_xlsx('data/lab1-commands.xlsx',sheet = 'Sheet1',range='A1:E57',na='')
```

本书后续章节相关部分还将涉及EViews编程的初级或中级技能。为了便于后续内容的学习，本书总结和梳理了常用的EViews函数命令（见表\@ref(tab:commands-show)），可以更好地配合EViews代码编写和运行，帮助完成计量经济学实证分析任务。

```{r commands-show,message=FALSE,echo=FALSE,results='asis',error=FALSE}
commands1<-subset(commands_set)
names(commands1)<-list('序号','分类','函数命令','作用','说明')
kable(commands1,booktabs = TRUE,
      caption = paste0("常用EViews函数命令",""),
      row.names = FALSE) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```



