{
  "hash": "22f5dc83952a5560292b3ca76972be9f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"实验06：异方差问题\"\nsubtitle: \"高管薪水案例\"\nauthor: \"任课教师：胡华平\"\ndate: \"2024-12-11\"\n\nexecute: \n  echo: false\n\nparams:\n  hand_out:\n    value:\n      lab_num: 6\n      name_chn: 异方差问题\n      name_eng: hetero\n  hw_start: '2024-12-11'\n  hw_end: '2024-12-18'\n  topic: 'hetero'\n  class: 'under'\n  id_year: '2022'\n  teach_year: '2024'\n  term: '2024'\n  course_id:\n    value:\n      academic: '6132001'\n      major: 'pd7134001'\n      under: '3133101'\n\nformat:\n  docx:\n    #output-file: homework02-test.docx\n    number-sections: true\n    highlight-style: github\n    reference-doc: ../template/template-word-lab-exrecise.docx\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n<br>\n\n学生姓名：_________；学生学号：___________；专业班级：__________\n\n<br>\n\n\n# 作业提交\n\n**实验发布时间**：2024-12-11（周三）24:00:00\n\n**提交截止时间**：2024-12-18（周三）24:00:00\n\n**实验提交材料**：\n\n（1）根据实验要求，完成Office Word电子文档一份（注意不能是wps文档），提交前请将文件命名为下述格式：lab06_word_张三_2019000001.docx。\n\n（2）根据实验要求，完成EViews相关操作，保存并提交1份EViews工作文件`.wfl文件`，提交前请将文件命名为下述格式：lab06_eviews_张三_2019000001.wfl。\n\n（3）根据实验要求，完成EViews相关操作，保存并提交1份EViews编程代码文件`.prg文件`，提交前请将文件命名为下述格式：lab06_code_张三_2019000001.prg。\n\n\n**实验提交方式**：\n\n- 登陆西北农林科技大学[在线教育综合平台](https://eol.nwafu.edu.cn/meol/index.do) ->> 进入课程《计量经济学》（胡华平主讲，课程编号3133101） ->> 进入【课程作业】进行作业资料下载和作业提交。\n\n- 请按上述要求命名各个提交文件。 系统提交页面中，务必让每个上传文件之间换行，保持提交页面布局美观！\n\n\n# 作业提示\n\n\n## 如何在word中编辑数学公式？\n\n（1）如果使用Office 2003版：“插入” $\\Rightarrow$“对象”$\\Rightarrow$“microsoft公式3.0”\n\n（2）如使用Office 2007/2010版：“插入”$\\Rightarrow$“新公式”\n\n（3）使用独立公式软件`Mathtype`，任何Office版本都可以\n\na.在`Mathtype`中编写公式$\\Rightarrow$ 确定无误后复制公式$\\Rightarrow$然后粘贴到word中。\n    \nb.在`Word`中修改Mathtype形式的公式：$\\Rightarrow$ 双击公式则可以打开Mathtype软件，然后按上一步骤操作，修改完成后，点击保存即可。\n\n<br>\n\n<br>\n\n\n\n\\newpage\n\n# 作业内容\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n> **温馨提示**：\n>（1）作业配套数据请在作业发布平台界面中自行下载。\n>（2）每个同学的数据都不一样（但样本数相同$n=447$）。请下载数据表后，按后面作业要求找到自己的数据，并进行Excel预处理（以便导入到Eviews）。\n\n\n\n为了分析企业高管薪水的影响因素，我们考虑如下所示的一些变量（具体定义见 @tbl-vars ）：\n\n\n\n::: {#tbl-vars .cell layout-align=\"center\" tbl-cap='变量定义及说明'}\n::: {.cell-output-display}\n\n\n| 变量_代码 |              含义               |\n|:---------:|:-------------------------------:|\n|    obs    |              样本               |\n|     Y     |         高管薪水及分红          |\n|    X2     | 担任CEO年数（不足6个月视为的0） |\n|    X3     |          总裁CEO的年龄          |\n|    X4     |        企业的总销售收入         |\n|    X5     |           企业的利润            |\n|    X6     |          企业的总资产           |\n\n\n:::\n:::\n\n\n\n\n\n下 @fig-data-show 给出了企业高管薪水实验案例的学生上机操作数据。\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![企业高管薪水案例的学生实验数据（n=447）](lab06-hetero_files/figure-docx/fig-data-show-1.png){#fig-data-show fig-align='center'}\n:::\n:::\n\n\n\n\\newpage\n\n# 作业任务\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n## 题目1：工作文件及数据导入\n\n（1）请大家下载本次作业数据文件到本地电脑。\n\n> **温馨提示**：a.文件尽量不要放在电脑桌面，而是保存在自己清楚的文件夹路径下（如\"D://econometrics//lab06\"）；b.注意下载工具的使用，不是直接打开xlsx文件，而是要下载到本地电脑，然后再打开！\n\n答：此问不用作答，完成指定操作即可！\n\n<br>\n\n（2）打开EViews软件，创建工作文件（WF），命名为lab06；以及建立工作页（page），命名为hetero。\n\n答：此问不用作答，完成指定操作即可！\n\n<br>\n\n（3）将工作文件项目保存到本地电脑`.wfl`文件，并命名为“lab06_eviews_张三_2019000001.wfl”的形式。\n\n> **要求**：注意记住保存的文件夹路径，这个文件要提交到作业系统的！！！\n\n答：此问不用作答，完成指定操作并确保正确即可！\n\n<br>\n\n（4）对xlsx数据文件进行处理，只保留数据列：obs、Y、X2、X3、X4、X5、X6），删除其他无关个人信息列。\n\n答：此问不用作答，完成指定操作并确保正确即可！\n\n<br>\n\n（4）将清洗处理好后的数据导入到刚才建好的Eviews工作文件中。\n\n答：此问不用作答，完成指定操作并确保正确即可！\n\n<br>\n\n## 题目2：理论模型设置分析\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n如果可以将高管薪水（$Y$）对数据集中其他变量（$X2,\\ldots,X6$）进行如下的线性建模（见模型 @eq-main ）：\n\n\n\n::: {.cell layout-align=\"center\"}\n$$\n\\begin{aligned}\n\\begin{split}\nY_i=&+\\beta_{1}+\\beta_{2}X2_i+\\beta_{3}X3_i\\\\&+\\beta_{4}X4_i+\\beta_{5}X5_i+\\beta_{6}X6_i+u_i\n\\end{split}\n\\quad \\text{(main)}\\quad\n\\end{aligned}\n$$ {#eq-main}\n:::\n\n\n\n请你对上述总体回归模型（PRM）的参数（$\\beta_1,\\beta_2,\\ldots,\\beta_6$）的理论预期（符号、大小、关系）进行判断，并给出基本的理由。\n\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n## 题目3：计算机自动回归分析\n\n\n运用Eviews菜单（Quick $\\Rightarrow$ Estimate Equation），对上述模型（见式 @eq-main ）进行回归分析。在Eviews软件中，以方程对象（Equation![](../pic/object/Equation.png)）形式保存上述回归结果，并命名为`eq_main`。最后截图到下列空白处。\n \n答：\n\n<br>\n\n<br>\n\n<!---\n\n（2）使用公式编辑器（或Mathtype软件），将上述EViews分析报告，手动整理成简要报告（四行报告，包括第1行样本回归方程、第2行对应的系数标准误、第3行对应的样本t统计量，以及第4行F检验值、p值、拟合优度等。具体形式见课件），将结果填写在下面空白处。\n\n答：\n\n<br>\n\n<br>\n\n--->\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n## 题目4：异方差问题的诊断（回归报告分析）\n\n根据上述的主回归模型 @eq-main 的EViews报告结果，请你分别得到t检验结论、判定系数、F检验结论。根据这些线索，请你进一步得出关于主模型是否存在异方差问题的初步结论。\n\n> **要求**：（1）明确给出t样本统计量、F样本统计量、判定系数的数值，并给出针对性结论；（2）相关数值结果保留4位小数。\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n\n## 题目5：异方差问题的诊断（残差相关计算）\n\n通过对主回归模型（见式 @eq-main ）的残差（$e_i$）序列模式图的观测和分析，我们可以对主回归模型是否存在异方差问题做出初步判断。请按要求得到残差序列的相关计算结果。\n\n（1）根据主回归模型的EViews操作，将模型残差$e_i$保存并命名为序列对象![](../pic/object/Series.png)`ei`。\n\n答：此题不需要作答，完成指定操作并确保正确即可！\n\n<br>\n\n<br>\n\n（2）在EViews中，分别计算得到残差的平方$e_i^2$、残差平方的对数$log(e_i^2)$、残差的绝对值$\\mid{e_i}\\mid$，分别保存并命名为序列对象：![](../pic/object/Series.png)`ei_sqr`、![](../pic/object/Series.png)`ei_sqr_log`、以及![](../pic/object/Series.png)`ei_abs`。\n\n答：此题不需要作答，完成指定操作并确保正确即可！\n\n<br>\n\n<br>\n\n（3）在EViews中，利用残差平方序列，请计算得到$\\tilde{\\sigma}^2$，然后保存标量对象：![](../pic/object/Scalar.png)`sigma2_wave`；进一步地，计算得到$P_i$，并保存为序列对象：![](../pic/object/Series.png)`Pi`。\n\n> **温馨提示**：\n\n$$\n\\begin{aligned}\n\\left[ P_{i}=\\frac{{e_i^2}} {\\tilde{\\sigma}^2};\\quad \\tilde{\\sigma}^2=\\frac{\\sum{e_i^2}} {n} \\right]\n\\end {aligned}\n$$\n\n答：此题不需要作答，完成指定操作并确保正确即可！\n\n<br>\n\n<br>\n\n（4）在EViews中，计算得到主模型的回归拟合值$\\hat{Y}_i$，保存并命名为序列对象：![](../pic/object/Series.png)`Y_hat`。\n\n> **温馨提示**：需要在EViews命令窗口中输出代码并执行：`eq_main.fit Y_hat`。表示提取回归方程对象![](../pic/object/Equation.png)`eq_main`的拟合值（fitted value）\n\n答：此题不需要作答，完成指定操作并确保正确即可！\n\n<br>\n\n<br>\n\n## 题目6：异方差问题的诊断（残差模式图）\n\n通过对主回归模型（见式 @eq-main ）的残差（$e_i$）序列模式图的观测和分析，我们可以对主回归模型是否存在异方差问题做出初步判断。请按要求绘制相关模式图。\n\n（1）在同一个图形对象内，以横轴为样本数，以纵轴为$e_i$序列和$e_i^2$序列，绘制描点图（dot plot），保存并命名该图形对象为：![](../pic/object/Graph.png)`graph_resid`。最后将该EViews图形对象“截图”复制到下面空白处。\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n（2）分别以$Y_i、X_i (i=2,⋯,6)$序列为横轴，以残差平方序列$e_i^2$为纵轴，请依次绘制6个散点图（scatter plot），并将图形对象分别保存和命名为![](../pic/object/Graph.png)：scatter_Y、scatter_X2、scatter_X3、scatter_X4、scatter_X5、scatter_X6。\n\n答：此题不需要作答，完成指定操作并确保正确即可！\n\n<br>\n\n<br>\n\n（3）根据以上的残差模式图分析，请你初步判断主模型（见式 @eq-main ）是否存在明显的异方差问题？异方差性的模式变化主要跟哪些因素存在何种关系？请简要说明理由。\n\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n\n## 题目7：异方差问题的诊断（Park检验法）\n\n（1）根据帕克检验（Park heteroscedastic test），结合本实验案例，请你写出一个适合本案例的帕克辅助回归模型.\n\n答：\n\n<br>\n\n$$\n\\begin{aligned}\n= \\qquad \\qquad \\qquad \\qquad \\qquad +v_i\\quad \\text{(aux_park)} \\quad \n\\end{aligned}\n$$ {#eq-aux-park}\n\n<br>\n\n<br>\n\n（2）利用EViews软件，针对主模型（见式 @eq-main ）是否存在异方差问题，请进行你所指定辅助回归（见式 @eq-aux-park ）的帕克检验。保存并命名该辅助方程对象为：![](../pic/object/Equation.png)`aux_park`。最后将该EViews方程对象“截图”复制到下面空白处。\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n（3）根据以上的帕克检验分析，请你初步判断主模型（见式 @eq-main ）是否存在明显的异方差问题？请简要说明理由。\n\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n## 题目8：异方差问题的诊断（格莱泽检验）\n\n（1）根据格莱泽检验（Glejser heteroscedastic test），结合本实验案例，请你分别写出三个**适合**本案例的格莱泽辅助回归模型（普通线性辅助模型、开根号辅助模型$\\sqrt{X_i}$和倒数辅助模型$\\frac{1}{X_i}$）。\n\n答：\n\n<br>\n\n$$\n\\begin{aligned}\n&= \\qquad \\qquad \\qquad \\qquad \\qquad +v_i\\quad &&\\text{(aux_glejer_ line)} \\quad\n\\end{aligned}\n$$ {#eq-aux-glejer-line} \n\n$$\n\\begin{aligned}\n&= \\qquad \\qquad \\qquad \\qquad \\qquad +v_i\\quad &&\\text{(aux_glejer_ root)} \\quad  \n\\end{aligned}\n$$ {#eq-aux-glejer-root}\n\n$$\n\\begin{aligned}\n&= \\qquad \\qquad \\qquad \\qquad \\qquad +v_i\\quad &&\\text{(aux_glejer_rep)} \\quad\n\\end{aligned}\n$$ {#eq-aux-glejer-rep}\n\n<br>\n\n<br>\n\n（2）利用EViews软件，针对主模型（见式 @eq-main ）是否存在异方差问题，请依次进行你所指定辅助回归（见式 @eq-aux-glejer-line 、式 @eq-aux-glejer-root 、 @eq-aux-glejer-rep ）的格莱泽检验。分别保存并命名3个辅助方程对象为![](../pic/object/Equation.png)：aux_glejer_line、aux_glejer_root、aux_glejer_rep。最后依次将上述EViews方程对象“截图”复制到下面空白处。\n\n\n答：1）格莱泽检验的普通线性辅助方程截图：![](../pic/object/Equation.png)`aux_glejer_line`\n\n<br>\n\n<br>\n\n答：2）格莱泽检验的开根号辅助方程（$\\sqrt{X_i}$）截图：![](../pic/object/Equation.png)`aux_glejer_root`\n\n<br>\n\n<br>\n\n答：3）格莱泽检验的倒数辅助方程（$\\frac{1}{X_i}$）截图：![](../pic/object/Equation.png)`aux_glejer_repo`\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n（3）根据以上的格莱泽检验分析，请你初步判断主模型（见式 @eq-main ）是否存在明显的异方差问题？请简要说明理由。\n\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n## 题目9：异方差问题的诊断（BPG检验）\n\n（1）根据BPG检验（Breusch-Pagan-Goldfrey heteroscedastic test），结合本实验案例，请你写出一个适合本案例的BPG辅助回归模型：\n\n$$\n\\begin{aligned}\n= \\qquad \\qquad \\qquad \\qquad \\qquad +v_i\\qquad \\text{(aux_bpg)} \\quad \n\\end{aligned}\n$$ {#eq-aux-bpg} \n\n\n（2）利用EViews软件，针对主模型（见式 @eq-main ）是否存在异方差问题，请进行你所指定辅助回归（见式 @eq-aux-bpg ）的BPG检验。保存并命名该辅助方程对象为：![](../pic/object/Equation.png)`aux_bpg`。最后将该EViews方程对象“截图”复制到下面空白处。\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n（3）根据以上的BPG检验分析，请你初步判断主模型（见式 @eq-main ）是否存在明显的异方差问题？请简要说明诊断依据和理由。（**要求**：写出LM统计量的理论公式和计算结果，数值保留4位小数）\n\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n\n## 题目10：异方差问题的诊断（怀特检验）\n\n（1）根据怀特检验（White heteroscedastic test），结合本实验案例，请你写出一个适合本案例的怀特辅助回归模型。（**要求**：辅助模型不考虑交叉项。）\n\n答：\n\n<br>\n\n$$\n\\begin{aligned}\n= \\qquad \\qquad \\qquad \\qquad \\qquad +v_i\\qquad \\text{(aux_white)} \\quad \n\\end{aligned}\n$$ {#eq-aux-white}\n\n\n<br>\n\n<br>\n\n（2）利用EViews软件，针对主模型（见式 @eq-main ）是否存在异方差问题，请进行你所指定辅助回归（见式 @eq-aux-white ）的怀特检验。保存并命名该辅助方程对象为：![](../pic/object/Equation.png)`aux_white`。最后将该EViews方程对象“截图”复制到下面空白处。\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n（3）根据以上的怀特检验分析，请你初步判断主模型（见式 @eq-main ）是否存在明显的异方差问题？请简要说明诊断依据和理由。（**要求**：写出卡方统计量${\\chi^2}^\\ast$的理论公式和计算结果，数值保留4位小数）\n\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n## 题目11：异方差问题的矫正（WLS方法）\n\n（1）根据上述的各类异方差诊断，请你判断并写出异方差的具体模式（见式 @eq-mode-hetero ）。进一步地，请你利用加权最小二乘法（WLS），构建一个适合本案例的WLS矫正方法和新模型，并从理论上证明该新模型（见式 @eq-wls ）。（**要求**：只写出1种你认为最可能的异方差模式，及其相应的WLS矫正方法。）\n\n答：1）异方差的具体模式是：\n\n<br>\n\n<br>\n\n$$\n\\begin{aligned}\nvar(u_i) &= \\qquad \\qquad \\qquad \\quad &&\\text{(mode_hetero)} \\quad \n\\end{aligned}\n$$ {#eq-mode-hetero}\n\n\n<br>\n\n<br>\n\n\n答：2）WLS矫正方法是：$\\ldots$。新模型的证明如下：$\\ldots$\n\n<br>\n\n$$\n\\begin{aligned}\nY^{\\ast}_i &=\\beta^{\\ast}_1+\\beta^{\\ast}_2X^{\\ast}_{2i}+ \\cdots +\\beta^{\\ast}_kX^{\\ast}_{ki}+v_{i} \\quad \\text{(eq_wls)} \\quad\n\\end{aligned}\n$$ {#eq-wls}\n\n<br>\n\n<br>\n\n（2）利用EViews软件，针对你的上述异方差WLS矫正方法，请对你设定的WLS新模型（见式 @eq-wls ）进行回归分析。保存并命名该方程对象为：![](../pic/object/Equation.png)`eq_wls`。最后将该EViews方程对象“截图”复制到下面空白处。\n\n答：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n（3）进一步地，请利用怀特检验法（不需要设交叉项）对你设定的上述WLS新模型（见式 @eq-wls ）做出诊断。请将怀特检验方程保存并命名为：![](../pic/object/Equation.png)`eq_wls_white`，并截图到下列空白处。最后请你判断WLS新模型是否消除或缓解了明显的异方差问题？请简要说明理由。\n\n\n答：1）怀特检验方程截图如下：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n答：2）怀特异方差诊断结论如下：\n\n<br>\n\n<br>\n\n<br>\n\n\n## 题目12：异方差问题的矫正（white一致标准误矫正法）\n\n一致标准误矫正法（consistent standard errors and covariance）有时候可以对存在异方差问题时的模型标准差做出改善和矫正。\n\n\n（1）请你利用EViews，对主模型（见式 @eq-main ）重新进行估计，设定“怀特一致标准误矫正”（White-Hinkley HC1 consistent standard errors and covariance）。请将“怀特一致标准误矫正”的方程保存并命名为：![](../pic/object/Equation.png)`eq_hc1_white`，并截图到下列空白处。\n\n答：“怀特一致标准误矫正”的方程截图如下：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n\n（2）请对比对主模型（见式 @eq-main ）的回归结果和“怀特一致标准误矫正”的回归结果。你能发现二者存在哪些异同之处？请简要回答并做出说明。\n\n答：二者的异同之处有：\n\n<br>\n\n<br>\n\n<br>\n\n<br>\n",
    "supporting": [
      "lab06-hetero_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}