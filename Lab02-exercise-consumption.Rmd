---
title: "Exercise Lab `r stringr::str_pad(params$hand_out$lab_num,2,'left','0')` 课程作业"
subtitle: " `r glue::glue('{params$hand_out$name_chn}')` "
author: "任课教师：胡华平"
date: "`r Sys.Date()`"
#knit: `r source("R/_render_public.R")`
knit: (function(inputFile, encoding) { 
  outFile <- sub(pattern = "(.*)\\..*$", replacement = "\\1", basename(inputFile));
  out_dir <- 'public';
  rmarkdown::render(inputFile,
                    encoding=encoding,
                     output_file=file.path(dirname(inputFile), out_dir, outFile)) })
params:
  hand_out:
    value:
      lab_num: 2
      name_chn: 一元回归分析过程（家庭消费案例）
      name_eng: EViews-basic-cpi
  hw_start: '2021-11-03'
  hw_end: '2021-11-23'
output:
  bookdown::word_document2:
    fig_caption: yes
    toc: no
    toc_depth: 4
    number_sections: true
    global_numbering: true
    #reference_docx: template/template-word-lab-exrecise.docx
  bookdown::pdf_document2:
    latex_engine: xelatex
    template: template/HWTemplate.tex
    fig_caption: yes
    includes:
      in_header: latex/header.tex
      before_body: latex/preamble.tex
    toc: no
    toc_depth: 5
    number_sections: yes
    keep_tex: yes
  bookdown::html_document2:
    number_sections: no
    toc: yes
    fig_caption: yes
    toc_float: yes
    mathjax: local
    self_contained: no
    highlight: tango
    theme: united
  word_document:
    toc: no
    toc_depth: '4'
    reference_docx: template/template-word-lab-exrecise.docx
  html_document: default
always_allow_html: yes
documentclass: article
classoption:
- (landscape
- a4paper)
- (portrait
- a4paper)
fontsize: 12pt
thanks: 请确保按要求独立完成，遵守诚信规范！
pagestyle: headings
---

```{r global_options, echo=F,message=FALSE,warning=F}
source("R/set-global-only.R", encoding = "UTF-8")
source("R/load-pkg.R", encoding = "UTF-8")
require(tidyverse)
require(magrittr)
require(glue)
require(here)
require(openxlsx)
require(knitr)

library(DT)
library(webshot)
library(htmlwidgets)
```

</br>

学生姓名：_________；学生学号：___________；专业班级：__________

</br>


# 作业提交

```{r, echo=FALSE}
start <- as.Date(params$hw_start)
start_line <- glue::glue("{start}（{weekdays(start)}）24:00:00")
end <- as.Date(params$hw_end)
end_line <- glue::glue("{end}（{weekdays(end)}）24:00:00")

source("R/fun_exercise_element.R", encoding = "UTF-8")
lab.num <- params$hand_out$lab_num
```

**作业发布时间**：`r start_line`

**提交截止时间**：`r end_line`

**作业提交材料**：

（1）根据作业要求，完成Office Word电子文档一份（注意不能是wps文档），提交前请将文件命名为下述格式：`r  name_file(num= lab.num)`。

（2）根据作业要求，完成EViews相关操作，保存并提交1份EViews工作文件`.wfl文件`，提交前请将文件命名为下述格式：`r  name_file(num= lab.num, ext='wfl')`。

\newpage


# 作业提示

## 实验参考材料

（1）【校内权限】在线教育综合平台（需校内登陆，网址[https://eol.nwafu.edu.cn/meol/index.do](https://eol.nwafu.edu.cn/meol/index.do)）：

《计量经济学》课程【实验课】指导书（**pdf版**）

```{r, fig.cap= "胡华平计量经济学（课程编号：3133101）"}
knitr::include_graphics("pic/course/econometrics-nwafu-course.png")
```


（2）【校外公开】胡华平个人网站（免费开放）：

a.计量经济学【实验课】指导书《计量经济学实验设计与应用：EViews软件实现》（**链接**[https://book.huhuaping.com/](https://book.huhuaping.com/)）。请参看“第1章 EViews 软件入门与基本操作”。

b.计量经济学【理论课】课件（**链接**[https://home.huhuaping.com/course-econometrics/schedule-theory/](https://home.huhuaping.com/course-econometrics/schedule-theory/)）


## 如何在word中编辑数学公式？

（1）如果使用Office 2003版：“插入” $\Rightarrow$“对象”$\Rightarrow$“microsoft公式3.0”

（2）如使用Office 2007/2010版：“插入”$\Rightarrow$“新公式”

（3）使用独立公式软件`Mathtype`，任何Office版本都可以

a.在`Mathtype`中编写公式$\Rightarrow$ 确定无误后复制公式$\Rightarrow$然后粘贴到word中
    
b.word`中修改Mathtype形式的公式：$\Rightarrow$ 双击公式则可以打开Mathtype软件，然后按上一步骤操作，修改完成后，点击保存即可。

</br>

## EViews对象的命名规则


```{r}
# give the symbol data
remark<-readxl::read_xlsx(path = "data/lab2-matrix-math.xlsx",sheet='symbols',range='A1:D17')
```


```{r remark,message=F,echo=FALSE,results='asis'}
library("knitr")
kable(remark,caption = "可能用到的Eviews对象的记号表达",row.names=FALSE)
```



## EViews对象的命名参考

```{r}
# give the math data
math_matrix<-readxl::read_xlsx(path = "data/lab2-matrix-math.xlsx",sheet='math',range='A1:F51')
  ## give the eviews name data
  var_name<-data.frame(t(math_matrix$name_eviews))
  names(var_name)<-math_matrix$name_eng
  ## give the math data
  var_math<-data.frame(t(math_matrix$math))
  names(var_math)<-math_matrix$name_eng

```

```{r,math-simple,message=F,echo=FALSE,results='asis'}
knitr::kable(
  subset(math_matrix,select = c("name_chn","cat_eng","math","name_eviews")), booktabs = TRUE,
  caption = '计算对象、表达式及Eviews命名')
```

\newpage

# 作业内容

<!---（Gujarati2011，练习题）--->

在一元线性回归的学习中，我们讨论了家庭收入（income）和消费支出（spend）案例。基于同一总体，每一个同学分别得到了自己的抽样数据（$n=10$），数据集见图\@ref(fig:data-students)。


> **温馨提示**：
>（1） 所有同学的X数据`income`都一样！
>（2）每个同学的Y数据`spend`都不一样！
>（3）请下载数据表后，找到自己的两列，并进行Excel预处理（以便导入到Eviews）。

<!--- DT table first （dummy no pic show）--->

```{r, screenshot.opts = list(selector = ".dataTables_wrapper")}
# DT table first. 
## it works and shows the webshot
DT::datatable(head(iris))
```


```{r}
file_path <- "data/lab2-monte-carlo-table-for-students-year-2021.xlsx"
df_students <- openxlsx::read.xlsx(file_path)
```


```{r data-sdutents, screenshot.opts = list(selector = ".dataTables_wrapper"),  fig.cap="家庭收入与支出案例数据"}
DT::datatable(df_students,
              #caption = "家庭收入与支出案例数据",
              options = list(
                dom ="tip",
                pageLength = "16"
              ))
```


# 作业任务

```{r task-counter}
task_counter <- function() {
  i <- 0
  function() {
    i <<- i + 1
    i
  }
}

n_task <- task_counter()

```

## 题目`r n_task()`：计算机自动分析

运用Eviews菜单（Quick $\Rightarrow$ Estimate Equation），对上述模型进行回归分析：

（1）将EViews回归报告截图，粘贴在下面空白处。
 
答：

</br>

</br>

（2）将上述EViews分析报告，手动整理成简要报告（四行报告，形式见课件），将结果填写在下面空白处。

答：

</br>

</br>

（3）把以上计算机“自动报告”结果与你后续“手动计算”的结果进行比较，判断后续手动计算的每一步是否正确。

> **温馨提示**：此小题不用作答，仅做后面参考。（要知道，后面手动计算中，一步错步步错！）。

答：此题不需要作答！仅作提示！



## 题目`r n_task()`：Eviews制图

利用Eviews将$(X,Y)$数据绘制**散点图**（scatter），并对残差序列$e_i$绘制**线图**(line plot)。

> **温馨提示**：在Eviews中精修美化图形，然后将图形复制到如下相应空白处。


答1：数据的散点图

</br>

</br>

答2：残差的线图

</br>

</br>

## 题目`r n_task()`：计算表FF和ff

将数据导入Eviews后，请分别计算出FF原序列![](pic/object/Series.png)：$X_i; Y_i; X^2_i; Y^2_i; X_iY_i$；以及ff离差序列![](pic/object/Series.png)：$(x_i; y_i; x^2_i;y^2_i,x_iy_i)$。在Eviews软件中，以Group对象![](pic/object/Group.png)形式分别保存，并分别截图到下列空白处。

答1：FF的Group截图

</br>

</br>

答2：ff的Group截图

</br>

</br>

## 题目`r n_task()`：计算回归系数

根据所给数据，利用Eviews软件，计算直线回归方程的回归系数。请在下面空白处写出公式、主要计算过程和计算结果；

> **温馨提示**：（1）请务必与第2题自动分析结果进行核验，确认你的计算结果是正确的。（2）结果保留四位小数。

答：

$\hat{\beta}_2=$

</br>

$\hat{\beta}_1=$

</br>

## 题目`r n_task()`：SRF和FRM

请样本回归模型（SRM）的理论表达式。并根据计算结果写出样本回归方程（SRF）的理论表达式和数值表达式。

> **要求**：（1）采用公式编辑器；（2）样本回归方程（SRF）的数值表达式中，数值结果保持4位小数。

答1：回归模型（SRM）的理论表达式（公式）

</br>

答2：样本回归方程（SRF）的理论表达式和数值表达式

</br>

</br>

## 题目`r n_task()`：残差序列

利用Eviews软件，先得到回归的残差$e_i$的序列对象![](pic/object/Series.png)`ei`，并进一步得到回归残差平方$e^2_i$的序列对象![](pic/object/Series.png)`ei_sqr`。将这两个序列构造为Group对象![](pic/object/Group.png)，并截图到下面空白处。

答：残差和残差平方序列的Group对象截图为：

</br>

</br>

## 题目`r n_task()`：回归误差方差和标准差

利用Eviews软件，计算回归方程的误差方差$\hat{\sigma}^2$及标准差$\hat{\sigma}$。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：（1）请务必与第2题自动分析结果进行核验，确认你的计算结果是正确的。（2）计算结果保留4位小数。

答1：

$\hat{\sigma}^2=$

</br>

答2：

$\hat{\sigma}=$

</br>

## 题目`r n_task()`：计算回归系数的样本方差

利用Eviews软件，分别计算处斜率系数的样本方差和标准差（$S_{\hat{\beta}_2}^2$、$S_{\hat{\beta}_2}^2$），以及截距系数的样本方差和标准差（$S_{\hat{\beta}_1}$、$S_{\hat{\beta}_1}$）。请在下面空白处分别写出理论公式及计算结果。

答：

$S_{\hat{\beta}_2}^2=$

</br>

$S_{\hat{\beta}_2}=$

</br>

$S_{\hat{\beta}_1}^2=$

</br>

$S_{\hat{\beta}_1}=$

</br>


## 题目`r n_task()`：方差分析表

利用Eviews软件，计算得到回归方程的平方和分解式（TSS、ESS、RSS）和各自的自由度（$df_{TSS}$、$df_{RSS}$、$df_{ESS}$）<!---，并写出方差分析表--->。请在下面空白处分别写出理论公式及计算结果。


答1：完成下述计算：

总平方和$TSS=$  ； 自由度$df_{TSS}=$   。

回归平方和$ESS=$  ； 自由度$df_{ESS}=$   。

残差平方和$RSS=$  ； 自由度$df_{RSS}=$   。

</br>

## 题目`r n_task()`：计算相关系数和判定系数

利用Eviews软件，计算得到自变量$X_i$与因变量$Y_i$的相关系数，以及回归方程的判定系数。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：（1）请务必与第2题自动分析结果进行核验，确认你的计算结果是正确的。（2）计算结果保留4位小数。

答1：相关系数$r_{(X,Y)}=$

</br>

答2：判定系数$r^2=$

</br>

## 题目`r n_task()`：回归系数的t检验

利用Eviews软件，首先请分别计算两个模型回归系数的样本t统计量值（$t^{\ast}_{\hat{\beta}}$）；然后使用EViews函数，得到给定$\alpha=0.05$时的t理论值（$t_{1-\alpha/2}(df)$）；最后根据计算结果完成对**斜率参数**的t检验过程。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：（1）请务必与第2题自动分析结果进行核验，确认你的计算结果是正确的。（2）计算结果保留4位小数。

答1：样本t统计量值（$t^{\ast}_{\hat{\beta}}$）

$t^{\ast}_{\hat{\beta}_2}=$

$t^{\ast}_{\hat{\beta}_1}=$

</br>



答2：EViews函数得到t理论查表值（给定$\alpha=0.05$）：

$t_{1-\alpha/2}(df)=$

$t_{alpha/2}(df)=$

</br>

答3：对**斜率系数**$\beta_2$的t检验过程：

</br>

</br>

## 题目`r n_task()`：回归方程整体显著性检验

利用Eviews软件，首先请回归方程的样本F统计量值（$F^\ast$）；然后使用EViews函数，得到给定$\alpha=0.05$时的F理论值（$f_{1-\alpha}(df_1,df_2)$）；最后根据计算结果完成对回归方程整体显著性检验过程。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：（1）请务必与第2题自动分析结果进行核验，确认你的计算结果是正确的。（2）计算结果保留4位小数。

答1：样本F统计量值

$F^\ast=$

</br>

答2：EViews函数得到F理论查表值（给定$\alpha=0.05$）：

$f_{1-\alpha}(df_1,df_2)=$

</br>

答3：对**斜率系数**$\beta_2$的t检验过程：

</br>

</br>


## 题目`r n_task()`：预测问题（点预测）

给定样本外$X_0 = 280$，请利用Eviews软件，分别计算均值和个值的点预测值。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：计算结果保留2位小数。

答1：均值的点预测值$E(Y|X=X_0)=$

</br>

答2：个值的点预测值$(Y_0|X=X_0)=$

</br>


## 题目`r n_task()`：预测问题（均值的区间预测）

利用Eviews软件，首先构造并得到均值预测时需要用到的样本标准差$S_{\hat{Y}_0}$；然后利用t分布（给定$\alpha =0.05$）构造出均值的区间预测。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：计算结果保留4位小数。

答1：需要用到的样本标准差$S_{\hat{Y}_0}=$

</br>

答2：均值的区间预测

左界值：$E(Y|X=X_0) \geq$

右界值：$E(Y|X=X_0) \leq$

</br>

## 题目`r n_task()`：预测问题（个值的区间预测）

利用Eviews软件，首先构造并得到**个值预测**时需要用到的样本标准差$S_{Y_0-\hat{Y}_0}$；然后利用t分布（给定$\alpha =0.05$）构造出均值的区间预测。请在下面空白处分别写出理论公式及计算结果。

> **温馨提示**：计算结果保留4位小数。

答1：需要用到的样本标准差$S_{Y_0-\hat{Y}_0}=$

</br>

答2：**个值**的区间预测

左界值：$(Y_0|X=X_0) \geq$

右界值：$(Y_0|X=X_0) \leq$

</br>

