---
title: "Exercise Lab `r stringr::str_pad(params$hand_out$lab_num,2,'left','0')` 课程作业"
subtitle: " `r glue::glue('{params$hand_out$name_chn}')` "
author: "任课教师：胡华平"
date: "`r Sys.Date()`"
knit: (function(inputFile, encoding) { 
  outFile <- sub(pattern = "(.*)\\..*$", replacement = "\\1", basename(inputFile));
  out_dir <- 'public';
  rmarkdown::render(inputFile,
                    encoding=encoding,
                    
                    output_file=file.path(dirname(inputFile), out_dir, outFile)) })
#knit: source(here::here("R","_render_single_2.R"), encoding="UTF-8")$value
params:
  hand_out:
    value:
      lab_num: 2
      name_chn: '一元回归OLS方法的分析过程'
      name_eng: "simple-reg-process"
  hw_start: "2021-11-03"
  hw_end: "2021-11-23"
output:
  bookdown::word_document2: 
    fig_caption:  true
    toc: no
    toc_depth: 4
    reference_docx: template/template-word-lab-exrecise.docx
  bookdown::html_document2:
    number_sections: no
    toc: yes
    fig_caption:  true
    toc_float: yes
    mathjax: local
    self_contained: no
    highlight: tango
    theme: united
  bookdown::pdf_document2:
    latex_engine: xelatex
    template: template/HWTemplate.tex
    fig_caption:  true
    includes:
      in_header: latex/header.tex
      before_body: latex/preamble.tex
    toc: no
    toc_depth: 5
    number_sections: yes
    keep_tex: true
always_allow_html: yes
documentclass: article
classoption: [(landscape,a4paper),(portrait,a4paper)]
fontsize: "12pt"
thanks: "请确保按要求独立完成，遵守诚信规范！"
pagestyle: "headings"

---

```{r,warning=FALSE, message=FALSE, echo=FALSE, eval=FALSE}
source("R/set-global-only.R")
#source("R/load-pkg.R")
require(tidyverse)
require(magrittr)
require(glue)
require(here)
require(openxlsx)
```

</br>

学生姓名：_________；学生学号：___________；专业班级：__________

</br>


# 作业提交

```{r, echo=FALSE}
start <- as.Date(params$hw_start)
start_line <- glue::glue("{start}（{weekdays(start)}）24:00:00")
end <- as.Date(params$hw_end)
end_line <- glue::glue("{end}（{weekdays(end)}）24:00:00")
```

**作业发布时间**：`r start_line`

**提交截止时间**：`r end_line`

**作业提交材料**：

1) 根据作业要求，完成手写纸质答题纸一份，按要求填写姓名和学号。

2) 根据作业要求，完成Office Word电子文档一份（注意不能是wps文档），文件命名为："姓名_学号.docx"。



\newpage

# 作业内容

根据已学知识，简单线性回归的主要分析过程中，出现下列公式和表达式，请同学们：

（1）使用纸质稿纸，两人一组，采用一人问一人答的方式，分别在稿纸上默写下列全部步骤及公式。

（2）使用微软Office Word软件，在台式机或笔记本电脑上，在word文档中正确且美观地输入下属全部步骤及公式。（提示：公式输入可以使用Mathtype软件。）

线性模型表达：

$$
\begin{aligned}
Y_i &=\beta_1+\beta_2X_i+u_i \quad \text{(PRM)}\\
Y_i &=\hat{\beta}_1+\hat{\beta}_2X_i+e_i \quad \text{(SRM)}
\end{aligned}
$$

FF原序列：$X_i; Y_i; X^2_i; Y^2_i; X_iY_i$。

ff离差序列：$(x_i; y_i; x^2_i;y^2_i,x_iy_i)$。

采用OLS方法对参数进行点估计的计算公式：

$$\begin{aligned}
\hat{\beta}_2 &=\frac{\sum{x_iy_i}}{\sum{x_i^2}} \\
\hat{\beta}_1 &= \bar{Y}-\hat{\beta}_2\bar{X} 
\end{aligned}$$

回归拟合值、拟合值的离差、回归残差和残差平方公式：

$$\begin{aligned}
\hat{Y_i} &=\hat{\beta}_1+\hat{\beta}_2\ast X_i \\
\hat{y}_i &=\hat{Y}_i-\bar{Y}\\
e_i &=Y_i-\hat{Y_i}\\
e^2_i&={(e_i)}^2
\end{aligned}$$

回归方程的误差方差及标准差公式：

$$\begin{aligned}
\hat{\sigma}^2 &=\frac{\sum{e_i^2}}{n-2} \\
\hat{\sigma} & =\sqrt{\frac{\sum{e_i^2}}{n-2}}
\end{aligned}$$



回归系数的样本方差和标准差计算公式：

$$\begin{alignedat}{2}
&S_{\hat{\beta}_2}^2 =\frac{\hat{\sigma}^2}{\sum{x_i^2}} ;\quad
&&S_{\hat{\beta}_2} =\sqrt{\frac{\hat{\sigma}^2}{\sum{x_i^2}}} \\
&S_{\hat{\beta}_1}^2 =\frac{\hat{\sigma}^2}{\sum{x_i^2}}\ast \frac{\sum{X^2_i}}{n} ;\quad
&&S_{\hat{\beta}_1} =\sqrt{\frac{\hat{\sigma}^2}{\sum{x_i^2}}\ast \frac{\sum{X^2_i}}{n}}
\end{alignedat}$$

方差分析表（ANOVA）理论公式：

$$\begin{alignedat}{2}
& TSS =\sum{(Y_i-\bar{Y})^2}=\sum{y_i^2} ; \quad
&& df_{TSS} =n-1 \\
&RSS=\sum{(Y_i-\hat{Y}_i)^2}  =\sum{e^2_i}; \quad
&& df_{RSS} =n-k\\
&ESS =\sum{(\hat{Y_i}-\bar{Y})^2} =\sum{\hat{y}_i^2}; \quad
&& df_{ESS} =k-1 \\
& TSS =RSS+ESS ; \quad
&& df_{TSS} =df_{RSS}+df_{ESS}
\end{alignedat}$$

相关系数和判定系数公式：

$$\begin{aligned}
r &=\frac{Cov(X,Y)}{S_X\ast S_Y}=\frac{\sum{(X_i-\bar{X})(Y_i-\bar{Y})}}{\sqrt{\sum{(X_i-\bar{X}})^2\sum{(Y_i-\bar{Y})^2}}}\\
r^2 &=\frac{ESS}{TSS}
\end{aligned}$$

斜率系数的样本t统计量计算公式为：

$$\begin{aligned}
T_{\hat{\beta}_2} &=\frac{\hat{\beta}_2 -\beta_2}{\sigma_{\hat{\beta}_2}} \sim t(n-2) \\
t^{\ast}_{\hat{\beta}_2} &=\frac{\hat{\beta}_2}{S_{\hat{\beta}_2}} \quad  \quad (H_0: \beta_2=0) \\
\end{aligned}$$

截距系数的样本t统计量计算公式为：

$$\begin{aligned}
T_{\hat{\beta}_1} &=\frac{\hat{\beta}_1 -\beta_1}{\sigma_{\hat{\beta}_1}} \sim t(n-2) \\
t^{\ast}_{\hat{\beta}_2} &=\frac{\hat{\beta}_1}{S_{\hat{\beta}_1}} \quad  \quad (H_0: \beta_1=0) \\
\end{aligned}$$

给定显著性水平下t分布的理论查表值表达式：

$$\begin{aligned}
t_{1-\alpha/2}(n-2); \quad or, \quad |{t_{\alpha/2}(n-2)}|
\end{aligned} 
$$

模型整体显著性检验的样本F统计量计算公式为：

$$
\begin{aligned}
F^\ast & ={\frac{MSS_{ESS}}{MSS_{RSS}}=\frac{ESS/df_ESS}{RSS/df_RSS}}\\
F_{rht} & =t_{1-\alpha/2}(df_{ESS},df_{RSS})=F_{0.95}(1,8)\\
F_{lft} & =t_{\alpha/2}(df_{ESS},df_{RSS})=F_{0.05}(1,8)
\end{aligned}$$
给定显著性水平下，F分布的理论查表值（单尾）的表达式：

$$\begin{aligned}
F_{1-\alpha}(df_{ESS},df_{RSS})
\end{aligned}$$

模型预测，初始条件：

$$\begin{aligned}
X_0 &=280 \\
\hat{Y_0} &=\hat{\beta_1}+\hat{\beta}_2\ast{X_0} 
\end{aligned}$$

模型预测，均值预测（区间预测）：

$$\begin{aligned}
\hat{Y}_0 - t_{1-\alpha/2}(df_{RSS}) \ast S_{\hat{Y}_0} 
& \leq \quad  E(Y|X=X_0) \quad \leq
\hat{Y}_0 + t_{1-\alpha/2}(df_{RSS}) \ast S_{\hat{Y}_0} \\
S_{\hat{Y}_0} &= \sqrt{\hat{\sigma}^2\left(\frac{1}{n}+\frac{(X_0-\bar{X})^2}{\sum{x_i^2}}\right)} \\
\hat{\sigma}^2&=\frac{\sum{e^2_i}}{(n-k)} 
\end{aligned}$$

模型预测，个值预测（区间预测）：

$$\begin{aligned}
\hat{Y}_0+t_{(1-\alpha/2)}(df_{RSS}) \ast S_{Y_0-\hat{Y}_0} 
& \leq (Y_0| X=X_0) \leq \hat{Y}_0-t_{(1-\alpha/2)}(df_{RSS}) \ast S_{Y_0-\hat{Y}_0}  \\
S_{Y_0-\hat{Y}_0} & = \sqrt{{\hat{\sigma}^2}{\left(1+\frac{1}{n}+\frac{{(X_0-\bar{X})}^2}{\sum{x^2_i}} \right)}} \\
\hat{\sigma}^2&=\frac{\sum{e^2_i}}{(n-k)} 
\end{aligned}$$